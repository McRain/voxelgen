"use strict";(self.webpackChunkvoxel_creator=self.webpackChunkvoxel_creator||[]).push([[229],{51:(e,a,t)=>{t.d(a,{f:()=>s});var s=function(){var e=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),a=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if("object"!=typeof WebAssembly)return{supported:!1};var t,s=WebAssembly.validate(e)?"b9H79TebbbeKl9Gbb9Gvuuuuueu9Giuuub9Geueuikqbbebeedddilve9Weeeviebeoweuec:q;Aekr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbdY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVblE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtboK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbrL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbwl79IV9RbDq;t9tqlbzik9:evu8Jjjjjbcz9Rhbcbheincbhdcbhiinabcwfadfaicjuaead4ceGglE86bbaialfhiadcefgdcw9hmbkaec:q:yjjbfai86bbaecitc:q1jjbfab8Piw83ibaecefgecjd9hmbkk;h8JlHud97euo978Jjjjjbcj;kb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Rad;8qbbcj;abad9UhoaicefhldnadTmbaoc;WFbGgocjdaocjd6EhwcbhDinaDae9pmeawaeaD9RaDawfae6Egqcsfgoc9WGgkci2hxakcethmaocl4cifcd4hPabaDad2fhscbhzdnincehHalhOcbhAdninaraO9RaP6miavcj;cbfaAak2fhCaOaPfhlcbhidnakc;ab6mbaral9Rc;Gb6mbcbhoinaCaofhidndndndndnaOaoco4fRbbgXciGPlbedibkaipxbbbbbbbbbbbbbbbbpklbxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklbalczfhlkdndndndndnaXcd4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklzxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklzalczfhlkdndndndndnaXcl4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklaxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklaalczfhlkdndndndndnaXco4Plbedibkaipxbbbbbbbbbbbbbbbbpkl8WxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WalclfaYpQbfaXc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WalcwfaYpQbfaXc:q:yjjbfRbbfhlxekaialpbbbpkl8Walczfhlkaoc;abfhiaocjefak0meaihoaral9Rc;Fb0mbkkdndnaiak9pmbaici4hoinaral9RcK6mdaCaifhXdndndndndnaOaico4fRbbaocoG4ciGPlbedibkaXpxbbbbbbbbbbbbbbbbpklbxikaXalpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaXalpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaXalpbbbpklbalczfhlkaocdfhoaiczfgiak6mbkkalTmbaAci6hHalhOaAcefgohAaoclSmdxekkcbhlaHceGmdkdnakTmbavcjdfazfhiavazfpbdbhYcbhXinaiavcj;cbfaXfgopblbgLcep9TaLpxeeeeeeeeeeeeeeeegQp9op9Hp9rgLaoakfpblbg8Acep9Ta8AaQp9op9Hp9rg8ApmbzeHdOiAlCvXoQrLgEaoamfpblbg3cep9Ta3aQp9op9Hp9rg3aoaxfpblbg5cep9Ta5aQp9op9Hp9rg5pmbzeHdOiAlCvXoQrLg8EpmbezHdiOAlvCXorQLgQaQpmbedibedibedibediaYp9UgYp9AdbbaiadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaEa8EpmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaLa8ApmwKDYq8AkEx3m5P8Es8FgLa3a5pmwKDYq8AkEx3m5P8Es8Fg8ApmbezHdiOAlvCXorQLgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaLa8ApmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfhiaXczfgXak6mbkkazclfgzad6mbkasavcjdfaqad2;8qbbavavcjdfaqcufad2fad;8qbbaqaDfhDc9:hoalmexikkc9:hoxekcbc99aral9Radcaadca0ESEhokavcj;kbf8Kjjjjbaokwbz:bjjjbk;uzeHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgDce0mbavc;abfcFecje;8kbavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhqaicefgwarfhodnaeTmbcmcsaDceSEhkcbhxcbhmcbhDcbhicbhlindnaoaq9nmbc9:hoxikdndnawRbbgrc;Ve0mbavc;abfalarcl4cu7fcsGcitfgPydlhsaPydbhzdnarcsGgPak9pmbavaiarcu7fcsGcdtfydbaxaPEhraPThPdndnadcd9hmbabaDcetfgHaz87ebaHcdfas87ebaHclfar87ebxekabaDcdtfgHazBdbaHclfasBdbaHcwfarBdbkaxaPfhxavc;abfalcitfgHarBdbaHasBdlavaicdtfarBdbavc;abfalcefcsGglcitfgHazBdbaHarBdlaiaPfhialcefhlxdkdndnaPcsSmbamaPfaPc987fcefhmxekaocefhrao8SbbgPcFeGhHdndnaPcu9mmbarhoxekaocvfhoaHcFbGhHcrhPdninar8SbbgOcFbGaPtaHVhHaOcu9kmearcefhraPcrfgPc8J9hmbxdkkarcefhokaHce4cbaHceG9R7amfhmkdndnadcd9hmbabaDcetfgraz87ebarcdfas87ebarclfam87ebxekabaDcdtfgrazBdbarclfasBdbarcwfamBdbkavc;abfalcitfgramBdbarasBdlavaicdtfamBdbavc;abfalcefcsGglcitfgrazBdbaramBdlaicefhialcefhlxekdnarcpe0mbaxcefgOavaiaqarcsGfRbbgPcl49RcsGcdtfydbaPcz6gHEhravaiaP9RcsGcdtfydbaOaHfgsaPcsGgOEhPaOThOdndnadcd9hmbabaDcetfgzax87ebazcdfar87ebazclfaP87ebxekabaDcdtfgzaxBdbazclfarBdbazcwfaPBdbkavaicdtfaxBdbavc;abfalcitfgzarBdbazaxBdlavaicefgicsGcdtfarBdbavc;abfalcefcsGcitfgzaPBdbazarBdlavaiaHfcsGgicdtfaPBdbavc;abfalcdfcsGglcitfgraxBdbaraPBdlalcefhlaiaOfhiasaOfhxxekaxcbaoRbbgzEgAarc;:eSgrfhsazcsGhCazcl4hXdndnazcs0mbascefhOxekashOavaiaX9RcsGcdtfydbhskdndnaCmbaOcefhxxekaOhxavaiaz9RcsGcdtfydbhOkdndnarTmbaocefhrxekaocdfhrao8SbegHcFeGhPdnaHcu9kmbaocofhAaPcFbGhPcrhodninar8SbbgHcFbGaotaPVhPaHcu9kmearcefhraocrfgoc8J9hmbkaAhrxekarcefhrkaPce4cbaPceG9R7amfgmhAkdndnaXcsSmbarhPxekarcefhPar8SbbgocFeGhHdnaocu9kmbarcvfhsaHcFbGhHcrhodninaP8SbbgrcFbGaotaHVhHarcu9kmeaPcefhPaocrfgoc8J9hmbkashPxekaPcefhPkaHce4cbaHceG9R7amfgmhskdndnaCcsSmbaPhoxekaPcefhoaP8SbbgrcFeGhHdnarcu9kmbaPcvfhOaHcFbGhHcrhrdninao8SbbgPcFbGartaHVhHaPcu9kmeaocefhoarcrfgrc8J9hmbkaOhoxekaocefhokaHce4cbaHceG9R7amfgmhOkdndnadcd9hmbabaDcetfgraA87ebarcdfas87ebarclfaO87ebxekabaDcdtfgraABdbarclfasBdbarcwfaOBdbkavc;abfalcitfgrasBdbaraABdlavaicdtfaABdbavc;abfalcefcsGcitfgraOBdbarasBdlavaicefgicsGcdtfasBdbavc;abfalcdfcsGcitfgraABdbaraOBdlavaiazcz6aXcsSVfgicsGcdtfaOBdbaiaCTaCcsSVfhialcifhlkawcefhwalcsGhlaicsGhiaDcifgDae6mbkkcbc99aoaqSEhokavc;aef8Kjjjjbaok:llevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:EPliuo97eue978Jjjjjbca9Rhidndnadcl9hmbdnaec98GglTmbcbhvabhdinadadpbbbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDpxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpkbbadczfhdavclfgval6mbkkalae9pmeaiaeciGgvcdtgdVcbczad9R;8kbaiabalcdtfglad;8qbbdnavTmbaiaipblbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDpxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpklbkalaiad;8qbbskdnaec98GgxTmbcbhvabhdinadczfglalpbbbgopxbbbbbbFFbbbbbbFFgkp9oadpbbbgDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eaDaopmbediwDqkzHOAKY8AEgoczp:Sep;6egrp;Geaoczp:Reczp:Sep;6egwp;Gep;Kep;Legopxb;:FSb;:FSb;:FSb;:FSawaopxbbbbbbbbbbbbbbbbp:2egqawpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegwawp;Meaoaop;Mearaqaramp9op9rp;Kegoaop;Mep;Kep;Kep;Jep;Negrp;Mepxbbn0bbn0bbn0bbn0gqp;Keczp:Reawarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9op9qgwaoarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogopmwDKYqk8AExm35Ps8E8Fp9qpkbbadaDakp9oawaopmbezHdiOAlvCXorQLp9qpkbbadcafhdavclfgvax6mbkkaxae9pmbaiaeciGgvcitgdfcbcaad9R;8kbaiabaxcitfglad;8qbbdnavTmbaiaipblzgopxbbbbbbFFbbbbbbFFgkp9oaipblbgDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eaDaopmbediwDqkzHOAKY8AEgoczp:Sep;6egrp;Geaoczp:Reczp:Sep;6egwp;Gep;Kep;Legopxb;:FSb;:FSb;:FSb;:FSawaopxbbbbbbbbbbbbbbbbp:2egqawpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegwawp;Meaoaop;Mearaqaramp9op9rp;Kegoaop;Mep;Kep;Kep;Jep;Negrp;Mepxbbn0bbn0bbn0bbn0gqp;Keczp:Reawarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9op9qgwaoarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogopmwDKYqk8AExm35Ps8E8Fp9qpklzaiaDakp9oawaopmbezHdiOAlvCXorQLp9qpklbkalaiad;8qbbkk;4wllue97euv978Jjjjjbc8W9Rhidnaec98GglTmbcbhvabhoinaiaopbbbgraoczfgwpbbbgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklbaopxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaqakp;Mearp;Keczp:ReaDakp;Mearp;Keamp9op9qgkpmbezHdiOAlvCXorQLgrp5baipblbpEb:T:j83ibaocwfarp5eaipblbpEe:T:j83ibawaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblbpEd:T:j83ibaocKfakp5eaipblbpEi:T:j83ibaocafhoavclfgval6mbkkdnalae9pmbaiaeciGgvcitgofcbcaao9R;8kbaiabalcitfgwao;8qbbdnavTmbaiaipblbgraipblzgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklaaipxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaqakp;Mearp;Keczp:ReaDakp;Mearp;Keamp9op9qgkpmbezHdiOAlvCXorQLgrp5baipblapEb:T:j83ibaiarp5eaipblapEe:T:j83iwaiaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblapEd:T:j83izaiakp5eaipblapEi:T:j83iKkawaiao;8qbbkk:Pddiue978Jjjjjbc;ab9Rhidnadcd4ae2glc98GgvTmbcbhdabheinaeaepbbbgocwp:Recwp:Sep;6eaocep:SepxbbjZbbjZbbjZbbjZp:UepxbbjFbbjFbbjFbbjFp9op;Mepkbbaeczfheadclfgdav6mbkkdnaval9pmbaialciGgdcdtgeVcbc;abae9R;8kbaiabavcdtfgvae;8qbbdnadTmbaiaipblbgocwp:Recwp:Sep;6eaocep:SepxbbjZbbjZbbjZbbjZp:UepxbbjFbbjFbbjFbbjFp9op;Mepklbkavaiae;8qbbkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaikkkebcjwklz9Tbb":"b9H79Tebbbe8Fv9Gbb9Gvuuuuueu9Giuuub9Geueu9Giuuueuikqbeeedddillviebeoweuec:q;iekr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbeY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVbdE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbiL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtblK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbol79IV9Rbrq:P8Yqdbk;3sezu8Jjjjjbcj;eb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Radz1jjjbhwcj;abad9UhoaicefhldnadTmbaoc;WFbGgocjdaocjd6EhDcbhqinaqae9pmeaDaeaq9RaqaDfae6Egkcsfgocl4cifcd4hxdndndndnaoc9WGgmTmbcbhPcehsawcjdfhzalhHinaraH9Rax6midnaraHaxfgl9RcK6mbczhoinawcj;cbfaogifgoc9WfhOdndndndndnaHaic9WfgAco4fRbbaAci4coG4ciGPlbedibkaO9cb83ibaOcwf9cb83ibxikaOalRblalRbbgAco4gCaCciSgCE86bbaocGfalclfaCfgORbbaAcl4ciGgCaCciSgCE86bbaocVfaOaCfgORbbaAcd4ciGgCaCciSgCE86bbaoc7faOaCfgORbbaAciGgAaAciSgAE86bbaoctfaOaAfgARbbalRbegOco4gCaCciSgCE86bbaoc91faAaCfgARbbaOcl4ciGgCaCciSgCE86bbaoc4faAaCfgARbbaOcd4ciGgCaCciSgCE86bbaoc93faAaCfgARbbaOciGgOaOciSgOE86bbaoc94faAaOfgARbbalRbdgOco4gCaCciSgCE86bbaoc95faAaCfgARbbaOcl4ciGgCaCciSgCE86bbaoc96faAaCfgARbbaOcd4ciGgCaCciSgCE86bbaoc97faAaCfgARbbaOciGgOaOciSgOE86bbaoc98faAaOfgORbbalRbiglco4gAaAciSgAE86bbaoc99faOaAfgORbbalcl4ciGgAaAciSgAE86bbaoc9:faOaAfgORbbalcd4ciGgAaAciSgAE86bbaocufaOaAfgoRbbalciGglalciSglE86bbaoalfhlxdkaOalRbwalRbbgAcl4gCaCcsSgCE86bbaocGfalcwfaCfgORbbaAcsGgAaAcsSgAE86bbaocVfaOaAfgORbbalRbegAcl4gCaCcsSgCE86bbaoc7faOaCfgORbbaAcsGgAaAcsSgAE86bbaoctfaOaAfgORbbalRbdgAcl4gCaCcsSgCE86bbaoc91faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc4faOaAfgORbbalRbigAcl4gCaCcsSgCE86bbaoc93faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc94faOaAfgORbbalRblgAcl4gCaCcsSgCE86bbaoc95faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc96faOaAfgORbbalRbvgAcl4gCaCcsSgCE86bbaoc97faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc98faOaAfgORbbalRbogAcl4gCaCcsSgCE86bbaoc99faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc9:faOaAfgORbbalRbrglcl4gAaAcsSgAE86bbaocufaOaAfgoRbbalcsGglalcsSglE86bbaoalfhlxekaOal8Pbb83bbaOcwfalcwf8Pbb83bbalczfhlkdnaiam9pmbaiczfhoaral9RcL0mekkaiam6mialTmidnakTmbawaPfRbbhOcbhoazhiinaiawcj;cbfaofRbbgAce4cbaAceG9R7aOfgO86bbaiadfhiaocefgoak9hmbkkazcefhzaPcefgPad6hsalhHaPad9hmexvkkcbhlasceGmdxikalaxad2fhCdnakTmbcbhHcehsawcjdfhminaral9Rax6mialTmdalaxfhlawaHfRbbhOcbhoamhiinaiawcj;cbfaofRbbgAce4cbaAceG9R7aOfgO86bbaiadfhiaocefgoak9hmbkamcefhmaHcefgHad6hsaHad9hmbkaChlxikcbhocehsinaral9Rax6mdalTmealaxfhlaocefgoad6hsadao9hmbkaChlxdkcbhlasceGTmekc9:hoxikabaqad2fawcjdfakad2z1jjjb8Aawawcjdfakcufad2fadz1jjjb8Aakaqfhqalmbkc9:hoxekcbc99aral9Radcaadca0ESEhokavcj;ebf8Kjjjjbaok;yzeHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgDce0mbavc;abfcFecjez:jjjjb8AavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhqaicefgwarfhodnaeTmbcmcsaDceSEhkcbhxcbhmcbhDcbhicbhlindnaoaq9nmbc9:hoxikdndnawRbbgrc;Ve0mbavc;abfalarcl4cu7fcsGcitfgPydlhsaPydbhzdnarcsGgPak9pmbavaiarcu7fcsGcdtfydbaxaPEhraPThPdndnadcd9hmbabaDcetfgHaz87ebaHcdfas87ebaHclfar87ebxekabaDcdtfgHazBdbaHclfasBdbaHcwfarBdbkaxaPfhxavc;abfalcitfgHarBdbaHasBdlavaicdtfarBdbavc;abfalcefcsGglcitfgHazBdbaHarBdlaiaPfhialcefhlxdkdndnaPcsSmbamaPfaPc987fcefhmxekaocefhrao8SbbgPcFeGhHdndnaPcu9mmbarhoxekaocvfhoaHcFbGhHcrhPdninar8SbbgOcFbGaPtaHVhHaOcu9kmearcefhraPcrfgPc8J9hmbxdkkarcefhokaHce4cbaHceG9R7amfhmkdndnadcd9hmbabaDcetfgraz87ebarcdfas87ebarclfam87ebxekabaDcdtfgrazBdbarclfasBdbarcwfamBdbkavc;abfalcitfgramBdbarasBdlavaicdtfamBdbavc;abfalcefcsGglcitfgrazBdbaramBdlaicefhialcefhlxekdnarcpe0mbaxcefgOavaiaqarcsGfRbbgPcl49RcsGcdtfydbaPcz6gHEhravaiaP9RcsGcdtfydbaOaHfgsaPcsGgOEhPaOThOdndnadcd9hmbabaDcetfgzax87ebazcdfar87ebazclfaP87ebxekabaDcdtfgzaxBdbazclfarBdbazcwfaPBdbkavaicdtfaxBdbavc;abfalcitfgzarBdbazaxBdlavaicefgicsGcdtfarBdbavc;abfalcefcsGcitfgzaPBdbazarBdlavaiaHfcsGgicdtfaPBdbavc;abfalcdfcsGglcitfgraxBdbaraPBdlalcefhlaiaOfhiasaOfhxxekaxcbaoRbbgzEgAarc;:eSgrfhsazcsGhCazcl4hXdndnazcs0mbascefhOxekashOavaiaX9RcsGcdtfydbhskdndnaCmbaOcefhxxekaOhxavaiaz9RcsGcdtfydbhOkdndnarTmbaocefhrxekaocdfhrao8SbegHcFeGhPdnaHcu9kmbaocofhAaPcFbGhPcrhodninar8SbbgHcFbGaotaPVhPaHcu9kmearcefhraocrfgoc8J9hmbkaAhrxekarcefhrkaPce4cbaPceG9R7amfgmhAkdndnaXcsSmbarhPxekarcefhPar8SbbgocFeGhHdnaocu9kmbarcvfhsaHcFbGhHcrhodninaP8SbbgrcFbGaotaHVhHarcu9kmeaPcefhPaocrfgoc8J9hmbkashPxekaPcefhPkaHce4cbaHceG9R7amfgmhskdndnaCcsSmbaPhoxekaPcefhoaP8SbbgrcFeGhHdnarcu9kmbaPcvfhOaHcFbGhHcrhrdninao8SbbgPcFbGartaHVhHaPcu9kmeaocefhoarcrfgrc8J9hmbkaOhoxekaocefhokaHce4cbaHceG9R7amfgmhOkdndnadcd9hmbabaDcetfgraA87ebarcdfas87ebarclfaO87ebxekabaDcdtfgraABdbarclfasBdbarcwfaOBdbkavc;abfalcitfgrasBdbaraABdlavaicdtfaABdbavc;abfalcefcsGcitfgraOBdbarasBdlavaicefgicsGcdtfasBdbavc;abfalcdfcsGcitfgraABdbaraOBdlavaiazcz6aXcsSVfgicsGcdtfaOBdbaiaCTaCcsSVfhialcifhlkawcefhwalcsGhlaicsGhiaDcifgDae6mbkkcbc99aoaqSEhokavc;aef8Kjjjjbaok:llevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:Lvoeue99dud99eud99dndnadcl9hmbaeTmeindndnabcdfgd8Sbb:Yab8Sbbgi:Ygl:l:tabcefgv8Sbbgo:Ygr:l:tgwJbb;:9cawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai86bbdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad86bbdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad86bbabclfhbaecufgembxdkkaeTmbindndnabclfgd8Ueb:Yab8Uebgi:Ygl:l:tabcdfgv8Uebgo:Ygr:l:tgwJb;:FSawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai87ebdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad87ebdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad87ebabcwfhbaecufgembkkk;siliui99iue99dnaeTmbcbhiabhlindndnJ;Zl81Zalcof8UebgvciV:Y:vgoal8Ueb:YNgrJb;:FSNJbbbZJbbb:;arJbbbb9GEMgw:lJbbb9p9DTmbaw:OhDxekcjjjj94hDkalclf8Uebhqalcdf8UebhkabavcefciGaiVcetfaD87ebdndnaoak:YNgwJb;:FSNJbbbZJbbb:;awJbbbb9GEMgx:lJbbb9p9DTmbax:Ohkxekcjjjj94hkkabavcdfciGaiVcetfak87ebdndnaoaq:YNgoJb;:FSNJbbbZJbbb:;aoJbbbb9GEMgx:lJbbb9p9DTmbax:Ohqxekcjjjj94hqkabavcufciGaiVcetfaq87ebdndnJbbjZararN:tawawN:taoaoN:tgrJbbbbarJbbbb9GE:rJb;:FSNJbbbZMgr:lJbbb9p9DTmbar:Ohqxekcjjjj94hqkabavciGaiVcetfaq87ebalcwfhlaiclfhiaecufgembkkk9mbdnadcd4ae2geTmbinababydbgdcwtcw91:Yadce91cjjj;8ifcjjj98G::NUdbabclfhbaecufgembkkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;LeeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiclfaeclfydbBdbaicwfaecwfydbBdbaicxfaecxfydbBdbaiczfhiaeczfheadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk;aeedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdbaicxfalBdbaicwfalBdbaiclfalBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabkkkebcjwklz9Kbb",n=WebAssembly.instantiate(i(s),{}).then(function(e){(t=e.instance).exports.__wasm_call_ctors()});function i(e){for(var t=new Uint8Array(e.length),s=0;s<e.length;++s){var n=e.charCodeAt(s);t[s]=n>96?n-97:n>64?n-39:n+4}var i=0;for(s=0;s<e.length;++s)t[i++]=t[s]<60?a[t[s]]:64*(t[s]-60)+t[++s];return t.buffer.slice(0,i)}function r(e,a,s,n,i,r){var o=t.exports.sbrk,c=s+3&-4,b=o(c*n),l=o(i.length),h=new Uint8Array(t.exports.memory.buffer);h.set(i,l);var p=e(b,s,n,l,i.length);if(0==p&&r&&r(b,c,n),a.set(h.subarray(b,b+s*n)),o(b-o(0)),0!=p)throw new Error("Malformed buffer data: "+p)}var o={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},c={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"},b=[],l=0;function h(e){var a={object:new Worker(e),pending:0,requests:{}};return a.object.onmessage=function(e){var t=e.data;a.pending-=t.count,a.requests[t.id][t.action](t.value),delete a.requests[t.id]},a}function p(e){for(var a="var instance; var ready = WebAssembly.instantiate(new Uint8Array(["+new Uint8Array(i(s))+"]), {}).then(function(result) { instance = result.instance; instance.exports.__wasm_call_ctors(); });self.onmessage = workerProcess;"+r.toString()+d.toString(),t=new Blob([a],{type:"text/javascript"}),n=URL.createObjectURL(t),o=0;o<e;++o)b[o]=h(n);URL.revokeObjectURL(n)}function d(e){n.then(function(){var a=e.data;try{var s=new Uint8Array(a.count*a.size);r(t.exports[a.mode],s,a.count,a.size,a.source,t.exports[a.filter]),self.postMessage({id:a.id,count:a.count,action:"resolve",value:s},[s.buffer])}catch(e){self.postMessage({id:a.id,count:a.count,action:"reject",value:e})}})}return{ready:n,supported:!0,useWorkers:function(e){p(e)},decodeVertexBuffer:function(e,a,s,n,i){r(t.exports.meshopt_decodeVertexBuffer,e,a,s,n,t.exports[o[i]])},decodeIndexBuffer:function(e,a,s,n){r(t.exports.meshopt_decodeIndexBuffer,e,a,s,n)},decodeIndexSequence:function(e,a,s,n){r(t.exports.meshopt_decodeIndexSequence,e,a,s,n)},decodeGltfBuffer:function(e,a,s,n,i,b){r(t.exports[c[i]],e,a,s,n,t.exports[o[b]])},decodeGltfBufferAsync:function(e,a,s,i,h){return b.length>0?function(e,a,t,s,n){for(var i=b[0],r=1;r<b.length;++r)b[r].pending<i.pending&&(i=b[r]);return new Promise(function(r,o){var c=new Uint8Array(t),b=l++;i.pending+=e,i.requests[b]={resolve:r,reject:o},i.object.postMessage({id:b,count:e,size:a,source:c,mode:s,filter:n},[c.buffer])})}(e,a,s,c[i],o[h]):n.then(function(){var n=new Uint8Array(e*a);return r(t.exports[c[i]],n,e,a,s,t.exports[o[h]]),n})}}}()},96:(e,a,t)=>{t.d(a,{r:()=>i});var s=t(922);const n={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class i{constructor(){this.textureUtils=null,this.pluginCallbacks=[],this.register(function(e){return new w(e)}),this.register(function(e){return new A(e)}),this.register(function(e){return new R(e)}),this.register(function(e){return new M(e)}),this.register(function(e){return new E(e)}),this.register(function(e){return new j(e)}),this.register(function(e){return new k(e)}),this.register(function(e){return new y(e)}),this.register(function(e){return new v(e)}),this.register(function(e){return new S(e)}),this.register(function(e){return new O(e)}),this.register(function(e){return new F(e)}),this.register(function(e){return new C(e)}),this.register(function(e){return new L(e)})}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}setTextureUtils(e){return this.textureUtils=e,this}parse(e,a,t,s){const n=new T,i=[];for(let e=0,a=this.pluginCallbacks.length;e<a;e++)i.push(this.pluginCallbacks[e](n));n.setPlugins(i),n.setTextureUtils(this.textureUtils),n.writeAsync(e,a,s).catch(t)}parseAsync(e,a){const t=this;return new Promise(function(s,n){t.parse(e,s,n,a)})}}const r=5120,o=5121,c=5122,b=5123,l=34962,h="KHR_mesh_quantization",p={};p[s.hxR]=9728,p[s.pHI]=9984,p[s.Cfg]=9986,p[s.k6q]=9729,p[s.kRr]=9985,p[s.$_I]=9987,p[s.ghU]=33071,p[s.GJx]=10497,p[s.kTW]=33648;const d={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},u=new s.Q1f;function f(e,a){return e.length===a.length&&e.every(function(e,t){return e===a[t]})}function m(e){return 4*Math.ceil(e/4)}function g(e,a=0){const t=m(e.byteLength);if(t!==e.byteLength){const s=new Uint8Array(t);if(s.set(new Uint8Array(e)),0!==a)for(let n=e.byteLength;n<t;n++)s[n]=a;return s.buffer}return e}function x(){return"undefined"==typeof document&&"undefined"!=typeof OffscreenCanvas?new OffscreenCanvas(1,1):document.createElement("canvas")}class T{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter r"+s.sPf}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map},this.textureUtils=null}setPlugins(e){this.plugins=e}setTextureUtils(e){this.textureUtils=e}async writeAsync(e,a,t={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},t),this.options.animations.length>0&&(this.options.trs=!0),await this.processInputAsync(e),await Promise.all(this.pending);const s=this,n=s.buffers,i=s.json;t=s.options;const r=s.extensionsUsed,o=s.extensionsRequired,c=new Blob(n,{type:"application/octet-stream"}),b=Object.keys(r),l=Object.keys(o);if(b.length>0&&(i.extensionsUsed=b),l.length>0&&(i.extensionsRequired=l),i.buffers&&i.buffers.length>0&&(i.buffers[0].byteLength=c.size),!0===t.binary){const e=new FileReader;e.readAsArrayBuffer(c),e.onloadend=function(){const t=g(e.result),s=new DataView(new ArrayBuffer(8));s.setUint32(0,t.byteLength,!0),s.setUint32(4,5130562,!0);const n=g((r=JSON.stringify(i),(new TextEncoder).encode(r).buffer),32);var r;const o=new DataView(new ArrayBuffer(8));o.setUint32(0,n.byteLength,!0),o.setUint32(4,1313821514,!0);const c=new ArrayBuffer(12),b=new DataView(c);b.setUint32(0,1179937895,!0),b.setUint32(4,2,!0);const l=12+o.byteLength+n.byteLength+s.byteLength+t.byteLength;b.setUint32(8,l,!0);const h=new Blob([c,o,n,s,t],{type:"application/octet-stream"}),p=new FileReader;p.readAsArrayBuffer(h),p.onloadend=function(){a(p.result)}}}else if(i.buffers&&i.buffers.length>0){const e=new FileReader;e.readAsDataURL(c),e.onloadend=function(){const t=e.result;i.buffers[0].uri=t,a(i)}}else a(i)}serializeUserData(e,a){if(0===Object.keys(e.userData).length)return;const t=this.options,s=this.extensionsUsed;try{const n=JSON.parse(JSON.stringify(e.userData));if(t.includeCustomExtensions&&n.gltfExtensions){void 0===a.extensions&&(a.extensions={});for(const e in n.gltfExtensions)a.extensions[e]=n.gltfExtensions[e],s[e]=!0;delete n.gltfExtensions}Object.keys(n).length>0&&(a.extras=n)}catch(a){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+a.message)}}getUID(e,a=!1){if(!1===this.uids.has(e)){const a=new Map;a.set(!0,this.uid++),a.set(!1,this.uid++),this.uids.set(e,a)}return this.uids.get(e).get(a)}isNormalizedNormalAttribute(e){if(this.cache.attributesNormalized.has(e))return!1;const a=new s.Pq0;for(let t=0,s=e.count;t<s;t++)if(Math.abs(a.fromBufferAttribute(e,t).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(e){const a=this.cache;if(a.attributesNormalized.has(e))return a.attributesNormalized.get(e);const t=e.clone(),n=new s.Pq0;for(let e=0,a=t.count;e<a;e++)n.fromBufferAttribute(t,e),0===n.x&&0===n.y&&0===n.z?n.setX(1):n.normalize(),t.setXYZ(e,n.x,n.y,n.z);return a.attributesNormalized.set(e,t),t}applyTextureTransform(e,a){let t=!1;const s={};0===a.offset.x&&0===a.offset.y||(s.offset=a.offset.toArray(),t=!0),0!==a.rotation&&(s.rotation=a.rotation,t=!0),1===a.repeat.x&&1===a.repeat.y||(s.scale=a.repeat.toArray(),t=!0),t&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=s,this.extensionsUsed.KHR_texture_transform=!0)}async buildMetalRoughTextureAsync(e,a){if(e===a)return e;function t(e){return e.colorSpace===s.er$?function(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}:function(e){return e}}e instanceof s.FvD&&(e=await this.decompressTextureAsync(e)),a instanceof s.FvD&&(a=await this.decompressTextureAsync(a));const n=e?e.image:null,i=a?a.image:null,r=Math.max(n?n.width:0,i?i.width:0),o=Math.max(n?n.height:0,i?i.height:0),c=x();c.width=r,c.height=o;const b=c.getContext("2d",{willReadFrequently:!0});b.fillStyle="#00ffff",b.fillRect(0,0,r,o);const l=b.getImageData(0,0,r,o);if(n){b.drawImage(n,0,0,r,o);const a=t(e),s=b.getImageData(0,0,r,o).data;for(let e=2;e<s.length;e+=4)l.data[e]=256*a(s[e]/256)}if(i){b.drawImage(i,0,0,r,o);const e=t(a),s=b.getImageData(0,0,r,o).data;for(let a=1;a<s.length;a+=4)l.data[a]=256*e(s[a]/256)}b.putImageData(l,0,0);const h=(e||a).clone();return h.source=new s.kLi(c),h.colorSpace=s.jf0,h.channel=(e||a).channel,e&&a&&e.channel!==a.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),h}async decompressTextureAsync(e,a=1/0){if(null===this.textureUtils)throw new Error("THREE.GLTFExporter: setTextureUtils() must be called to process compressed textures.");return await this.textureUtils.decompress(e,a)}processBuffer(e){const a=this.json,t=this.buffers;return a.buffers||(a.buffers=[{byteLength:0}]),t.push(e),0}processBufferView(e,a,t,n,i){const h=this.json;let p;switch(h.bufferViews||(h.bufferViews=[]),a){case r:case o:p=1;break;case c:case b:p=2;break;default:p=4}let d=e.itemSize*p;i===l&&(d=4*Math.ceil(d/4));const u=m(n*d),f=new DataView(new ArrayBuffer(u));let g=0;for(let i=t;i<t+n;i++){for(let t=0;t<e.itemSize;t++){let n;e.itemSize>4?n=e.array[i*e.itemSize+t]:(0===t?n=e.getX(i):1===t?n=e.getY(i):2===t?n=e.getZ(i):3===t&&(n=e.getW(i)),!0===e.normalized&&(n=s.cj9.normalize(n,e.array))),5126===a?f.setFloat32(g,n,!0):5124===a?f.setInt32(g,n,!0):5125===a?f.setUint32(g,n,!0):a===c?f.setInt16(g,n,!0):a===b?f.setUint16(g,n,!0):a===r?f.setInt8(g,n):a===o&&f.setUint8(g,n),g+=p}g%d!==0&&(g+=d-g%d)}const x={buffer:this.processBuffer(f.buffer),byteOffset:this.byteOffset,byteLength:u};return void 0!==i&&(x.target=i),i===l&&(x.byteStride=d),this.byteOffset+=u,h.bufferViews.push(x),{id:h.bufferViews.length-1,byteLength:0}}processBufferViewImage(e){const a=this,t=a.json;return t.bufferViews||(t.bufferViews=[]),new Promise(function(s){const n=new FileReader;n.readAsArrayBuffer(e),n.onloadend=function(){const e=g(n.result),i={buffer:a.processBuffer(e),byteOffset:a.byteOffset,byteLength:e.byteLength};a.byteOffset+=e.byteLength,s(t.bufferViews.push(i)-1)}})}processAccessor(e,a,t,n){const i=this.json;let h;if(e.array.constructor===Float32Array)h=5126;else if(e.array.constructor===Int32Array)h=5124;else if(e.array.constructor===Uint32Array)h=5125;else if(e.array.constructor===Int16Array)h=c;else if(e.array.constructor===Uint16Array)h=b;else if(e.array.constructor===Int8Array)h=r;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+e.array.constructor.name);h=o}if(void 0===t&&(t=0),void 0!==n&&n!==1/0||(n=e.count),0===n)return null;const p=function(e,a,t){const n={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let i=a;i<a+t;i++)for(let a=0;a<e.itemSize;a++){let t;e.itemSize>4?t=e.array[i*e.itemSize+a]:(0===a?t=e.getX(i):1===a?t=e.getY(i):2===a?t=e.getZ(i):3===a&&(t=e.getW(i)),!0===e.normalized&&(t=s.cj9.normalize(t,e.array))),n.min[a]=Math.min(n.min[a],t),n.max[a]=Math.max(n.max[a],t)}return n}(e,t,n);let d;void 0!==a&&(d=e===a.index?34963:l);const u=this.processBufferView(e,h,t,n,d),f={bufferView:u.id,byteOffset:u.byteOffset,componentType:h,count:n,max:p.max,min:p.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"}[e.itemSize]};return!0===e.normalized&&(f.normalized=!0),i.accessors||(i.accessors=[]),i.accessors.push(f)-1}processImage(e,a,t,n="image/png"){if(null!==e){const i=this,r=i.cache,o=i.json,c=i.options,b=i.pending;r.images.has(e)||r.images.set(e,{});const l=r.images.get(e),h=n+":flipY/"+t.toString();if(void 0!==l[h])return l[h];o.images||(o.images=[]);const p={mimeType:n},d=x();d.width=Math.min(e.width,c.maxTextureSize),d.height=Math.min(e.height,c.maxTextureSize);const u=d.getContext("2d",{willReadFrequently:!0});if(!0===t&&(u.translate(0,d.height),u.scale(1,-1)),void 0!==e.data){a!==s.GWd&&console.error("GLTFExporter: Only RGBAFormat is supported.",a),(e.width>c.maxTextureSize||e.height>c.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);const t=new Uint8ClampedArray(e.height*e.width*4);for(let a=0;a<t.length;a+=4)t[a+0]=e.data[a+0],t[a+1]=e.data[a+1],t[a+2]=e.data[a+2],t[a+3]=e.data[a+3];u.putImageData(new ImageData(t,e.width,e.height),0,0)}else{if(!("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas))throw new Error("THREE.GLTFExporter: Invalid image type. Use HTMLImageElement, HTMLCanvasElement, ImageBitmap or OffscreenCanvas.");u.drawImage(e,0,0,d.width,d.height)}!0===c.binary?b.push(function(e,a){if(void 0!==e.toBlob)return new Promise(t=>e.toBlob(t,a));let t;return"image/jpeg"===a?t=.92:"image/webp"===a&&(t=.8),e.convertToBlob({type:a,quality:t})}(d,n).then(e=>i.processBufferViewImage(e)).then(e=>{p.bufferView=e})):p.uri=s.HgN.getDataURL(d,n);const f=o.images.push(p)-1;return l[h]=f,f}throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(e){const a=this.json;a.samplers||(a.samplers=[]);const t={magFilter:p[e.magFilter],minFilter:p[e.minFilter],wrapS:p[e.wrapS],wrapT:p[e.wrapT]};return a.samplers.push(t)-1}async processTextureAsync(e){const a=this.options,t=this.cache,n=this.json;if(t.textures.has(e))return t.textures.get(e);n.textures||(n.textures=[]),e instanceof s.FvD&&(e=await this.decompressTextureAsync(e,a.maxTextureSize));let i=e.userData.mimeType;"image/webp"===i&&(i="image/png");const r={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY,i)};e.name&&(r.name=e.name),await this._invokeAllAsync(async function(a){a.writeTexture&&await a.writeTexture(e,r)});const o=n.textures.push(r)-1;return t.textures.set(e,o),o}async processMaterialAsync(e){const a=this.cache,t=this.json;if(a.materials.has(e))return a.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;t.materials||(t.materials=[]);const n={pbrMetallicRoughness:{}};!0!==e.isMeshStandardMaterial&&!0!==e.isMeshBasicMaterial&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const i=e.color.toArray().concat([e.opacity]);if(f(i,[1,1,1,1])||(n.pbrMetallicRoughness.baseColorFactor=i),e.isMeshStandardMaterial?(n.pbrMetallicRoughness.metallicFactor=e.metalness,n.pbrMetallicRoughness.roughnessFactor=e.roughness):(n.pbrMetallicRoughness.metallicFactor=0,n.pbrMetallicRoughness.roughnessFactor=1),e.metalnessMap||e.roughnessMap){const a=await this.buildMetalRoughTextureAsync(e.metalnessMap,e.roughnessMap),t={index:await this.processTextureAsync(a),texCoord:a.channel};this.applyTextureTransform(t,a),n.pbrMetallicRoughness.metallicRoughnessTexture=t}if(e.map){const a={index:await this.processTextureAsync(e.map),texCoord:e.map.channel};this.applyTextureTransform(a,e.map),n.pbrMetallicRoughness.baseColorTexture=a}if(e.emissive){const a=e.emissive;if(Math.max(a.r,a.g,a.b)>0&&(n.emissiveFactor=e.emissive.toArray()),e.emissiveMap){const a={index:await this.processTextureAsync(e.emissiveMap),texCoord:e.emissiveMap.channel};this.applyTextureTransform(a,e.emissiveMap),n.emissiveTexture=a}}if(e.normalMap){const a={index:await this.processTextureAsync(e.normalMap),texCoord:e.normalMap.channel};e.normalScale&&1!==e.normalScale.x&&(a.scale=e.normalScale.x),this.applyTextureTransform(a,e.normalMap),n.normalTexture=a}if(e.aoMap){const a={index:await this.processTextureAsync(e.aoMap),texCoord:e.aoMap.channel};1!==e.aoMapIntensity&&(a.strength=e.aoMapIntensity),this.applyTextureTransform(a,e.aoMap),n.occlusionTexture=a}e.transparent?n.alphaMode="BLEND":e.alphaTest>0&&(n.alphaMode="MASK",n.alphaCutoff=e.alphaTest),e.side===s.$EB&&(n.doubleSided=!0),""!==e.name&&(n.name=e.name),this.serializeUserData(e,n),await this._invokeAllAsync(async function(a){a.writeMaterialAsync&&await a.writeMaterialAsync(e,n)});const r=t.materials.push(n)-1;return a.materials.set(e,r),r}async processMeshAsync(e){const a=this.cache,t=this.json,n=[e.geometry.uuid];if(Array.isArray(e.material))for(let a=0,t=e.material.length;a<t;a++)n.push(e.material[a].uuid);else n.push(e.material.uuid);const r=n.join(":");if(a.meshes.has(r))return a.meshes.get(r);const o=e.geometry;let c;c=e.isLineSegments?1:e.isLineLoop?2:e.isLine?3:e.isPoints?0:e.material.wireframe?1:4;const b={},l={},h=[],p=[],d={uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},u=o.getAttribute("normal");void 0===u||this.isNormalizedNormalAttribute(u)||(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),o.setAttribute("normal",this.createNormalizedNormalAttribute(u)));let f=null;for(let e in o.attributes){if("morph"===e.slice(0,5))continue;const t=o.attributes[e];if(e=d[e]||e.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(e)||(e="_"+e),a.attributes.has(this.getUID(t))){l[e]=a.attributes.get(this.getUID(t));continue}f=null;const n=t.array;"JOINTS_0"!==e||n instanceof Uint16Array||n instanceof Uint8Array?(n instanceof Uint32Array||n instanceof Int32Array)&&!e.startsWith("_")&&(console.warn(`GLTFExporter: Attribute "${e}" converted to type FLOAT.`),f=i.Utils.toFloat32BufferAttribute(t)):(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),f=new s.THS(new Uint16Array(n),t.itemSize,t.normalized));const r=this.processAccessor(f||t,o);null!==r&&(e.startsWith("_")||this.detectMeshQuantization(e,t),l[e]=r,a.attributes.set(this.getUID(t),r))}if(void 0!==u&&o.setAttribute("normal",u),0===Object.keys(l).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){const t=[],s=[],n={};if(void 0!==e.morphTargetDictionary)for(const a in e.morphTargetDictionary)n[e.morphTargetDictionary[a]]=a;for(let i=0;i<e.morphTargetInfluences.length;++i){const r={};let c=!1;for(const e in o.morphAttributes){if("position"!==e&&"normal"!==e){c||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),c=!0);continue}const t=o.morphAttributes[e][i],s=e.toUpperCase(),n=o.attributes[e];if(a.attributes.has(this.getUID(t,!0))){r[s]=a.attributes.get(this.getUID(t,!0));continue}const b=t.clone();if(!o.morphTargetsRelative)for(let e=0,a=t.count;e<a;e++)for(let a=0;a<t.itemSize;a++)0===a&&b.setX(e,t.getX(e)-n.getX(e)),1===a&&b.setY(e,t.getY(e)-n.getY(e)),2===a&&b.setZ(e,t.getZ(e)-n.getZ(e)),3===a&&b.setW(e,t.getW(e)-n.getW(e));r[s]=this.processAccessor(b,o),a.attributes.set(this.getUID(n,!0),r[s])}p.push(r),t.push(e.morphTargetInfluences[i]),void 0!==e.morphTargetDictionary&&s.push(n[i])}b.weights=t,s.length>0&&(b.extras={},b.extras.targetNames=s)}const m=Array.isArray(e.material);if(m&&0===o.groups.length)return null;let g=!1;if(m&&null===o.index){const e=[];for(let a=0,t=o.attributes.position.count;a<t;a++)e[a]=a;o.setIndex(e),g=!0}const x=m?e.material:[e.material],T=m?o.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let e=0,t=T.length;e<t;e++){const t={mode:c,attributes:l};if(this.serializeUserData(o,t),p.length>0&&(t.targets=p),null!==o.index){let s=this.getUID(o.index);void 0===T[e].start&&void 0===T[e].count||(s+=":"+T[e].start+":"+T[e].count),a.attributes.has(s)?t.indices=a.attributes.get(s):(t.indices=this.processAccessor(o.index,o,T[e].start,T[e].count),a.attributes.set(s,t.indices)),null===t.indices&&delete t.indices}const s=await this.processMaterialAsync(x[T[e].materialIndex]);null!==s&&(t.material=s),h.push(t)}!0===g&&o.setIndex(null),b.primitives=h,t.meshes||(t.meshes=[]),await this._invokeAllAsync(function(a){a.writeMesh&&a.writeMesh(e,b)});const w=t.meshes.push(b)-1;return a.meshes.set(r,w),w}detectMeshQuantization(e,a){if(this.extensionsUsed[h])return;let t;switch(a.array.constructor){case Int8Array:t="byte";break;case Uint8Array:t="unsigned byte";break;case Int16Array:t="short";break;case Uint16Array:t="unsigned short";break;default:return}a.normalized&&(t+=" normalized");const s=e.split("_",1)[0];n[s]&&n[s].includes(t)&&(this.extensionsUsed[h]=!0,this.extensionsRequired[h]=!0)}processCamera(e){const a=this.json;a.cameras||(a.cameras=[]);const t=e.isOrthographicCamera,n={type:t?"orthographic":"perspective"};return t?n.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:n.perspective={aspectRatio:e.aspect,yfov:s.cj9.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(n.name=e.type),a.cameras.push(n)-1}processAnimation(e,a){const t=this.json,n=this.nodeMap;t.animations||(t.animations=[]);const r=(e=i.Utils.mergeMorphTargetTracks(e.clone(),a)).tracks,o=[],c=[];for(let e=0;e<r.length;++e){const t=r[e],i=s.Nwf.parseTrackName(t.name);let b=s.Nwf.findNode(a,i.nodeName);const l=d[i.propertyName];if("bones"===i.objectName&&(b=!0===b.isSkinnedMesh?b.skeleton.getBoneByName(i.objectIndex):void 0),!b||!l){console.warn('THREE.GLTFExporter: Could not export animation track "%s".',t.name);continue}const h=1;let p,u=t.values.length/t.times.length;l===d.morphTargetInfluences&&(u/=b.morphTargetInfluences.length),!0===t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(p="CUBICSPLINE",u/=3):p=t.getInterpolation()===s.ljd?"STEP":"LINEAR",c.push({input:this.processAccessor(new s.THS(t.times,h)),output:this.processAccessor(new s.THS(t.values,u)),interpolation:p}),o.push({sampler:c.length-1,target:{node:n.get(b),path:l}})}return t.animations.push({name:e.name||"clip_"+t.animations.length,samplers:c,channels:o}),t.animations.length-1}processSkin(e){const a=this.json,t=this.nodeMap,n=a.nodes[t.get(e)],i=e.skeleton;if(void 0===i)return null;const r=e.skeleton.bones[0];if(void 0===r)return null;const o=[],c=new Float32Array(16*i.bones.length),b=new s.kn4;for(let a=0;a<i.bones.length;++a)o.push(t.get(i.bones[a])),b.copy(i.boneInverses[a]),b.multiply(e.bindMatrix).toArray(c,16*a);return void 0===a.skins&&(a.skins=[]),a.skins.push({inverseBindMatrices:this.processAccessor(new s.THS(c,16)),joints:o,skeleton:t.get(r)}),n.skin=a.skins.length-1}async processNodeAsync(e){const a=this.json,t=this.options,s=this.nodeMap;a.nodes||(a.nodes=[]);const n={};if(t.trs){const a=e.quaternion.toArray(),t=e.position.toArray(),s=e.scale.toArray();f(a,[0,0,0,1])||(n.rotation=a),f(t,[0,0,0])||(n.translation=t),f(s,[1,1,1])||(n.scale=s)}else e.matrixAutoUpdate&&e.updateMatrix(),!1===f(e.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])&&(n.matrix=e.matrix.elements);if(""!==e.name&&(n.name=String(e.name)),this.serializeUserData(e,n),e.isMesh||e.isLine||e.isPoints){const a=await this.processMeshAsync(e);null!==a&&(n.mesh=a)}else e.isCamera&&(n.camera=this.processCamera(e));e.isSkinnedMesh&&this.skins.push(e);const i=a.nodes.push(n)-1;if(s.set(e,i),e.children.length>0){const a=[];for(let s=0,n=e.children.length;s<n;s++){const n=e.children[s];if(n.visible||!1===t.onlyVisible){const e=await this.processNodeAsync(n);null!==e&&a.push(e)}}a.length>0&&(n.children=a)}return await this._invokeAllAsync(function(a){a.writeNode&&a.writeNode(e,n)}),i}async processSceneAsync(e){const a=this.json,t=this.options;a.scenes||(a.scenes=[],a.scene=0);const s={};""!==e.name&&(s.name=e.name),a.scenes.push(s);const n=[];for(let a=0,s=e.children.length;a<s;a++){const s=e.children[a];if(s.visible||!1===t.onlyVisible){const e=await this.processNodeAsync(s);null!==e&&n.push(e)}}n.length>0&&(s.nodes=n),this.serializeUserData(e,s)}async processObjectsAsync(e){const a=new s.Z58;a.name="AuxScene";for(let t=0;t<e.length;t++)a.children.push(e[t]);await this.processSceneAsync(a)}async processInputAsync(e){const a=this.options;e=e instanceof Array?e:[e],await this._invokeAllAsync(function(a){a.beforeParse&&a.beforeParse(e)});const t=[];for(let a=0;a<e.length;a++)e[a]instanceof s.Z58?await this.processSceneAsync(e[a]):t.push(e[a]);t.length>0&&await this.processObjectsAsync(t);for(let e=0;e<this.skins.length;++e)this.processSkin(this.skins[e]);for(let t=0;t<a.animations.length;++t)this.processAnimation(a.animations[t],e[0]);await this._invokeAllAsync(function(a){a.afterParse&&a.afterParse(e)})}async _invokeAllAsync(e){for(let a=0,t=this.plugins.length;a<t;a++)await e(this.plugins[a])}}class w{constructor(e){this.writer=e,this.name="KHR_lights_punctual"}writeNode(e,a){if(!e.isLight)return;if(!e.isDirectionalLight&&!e.isPointLight&&!e.isSpotLight)return void console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e);const t=this.writer,s=t.json,n=t.extensionsUsed,i={};e.name&&(i.name=e.name),i.color=e.color.toArray(),i.intensity=e.intensity,e.isDirectionalLight?i.type="directional":e.isPointLight?(i.type="point",e.distance>0&&(i.range=e.distance)):e.isSpotLight&&(i.type="spot",e.distance>0&&(i.range=e.distance),i.spot={},i.spot.innerConeAngle=(1-e.penumbra)*e.angle,i.spot.outerConeAngle=e.angle),void 0!==e.decay&&2!==e.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),!e.target||e.target.parent===e&&0===e.target.position.x&&0===e.target.position.y&&-1===e.target.position.z||console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),n[this.name]||(s.extensions=s.extensions||{},s.extensions[this.name]={lights:[]},n[this.name]=!0);const r=s.extensions[this.name].lights;r.push(i),a.extensions=a.extensions||{},a.extensions[this.name]={light:r.length-1}}}class A{constructor(e){this.writer=e,this.name="KHR_materials_unlit"}async writeMaterialAsync(e,a){if(!e.isMeshBasicMaterial)return;const t=this.writer.extensionsUsed;a.extensions=a.extensions||{},a.extensions[this.name]={},t[this.name]=!0,a.pbrMetallicRoughness.metallicFactor=0,a.pbrMetallicRoughness.roughnessFactor=.9}}class k{constructor(e){this.writer=e,this.name="KHR_materials_clearcoat"}async writeMaterialAsync(e,a){if(!e.isMeshPhysicalMaterial||0===e.clearcoat)return;const t=this.writer,s=t.extensionsUsed,n={};if(n.clearcoatFactor=e.clearcoat,e.clearcoatMap){const a={index:await t.processTextureAsync(e.clearcoatMap),texCoord:e.clearcoatMap.channel};t.applyTextureTransform(a,e.clearcoatMap),n.clearcoatTexture=a}if(n.clearcoatRoughnessFactor=e.clearcoatRoughness,e.clearcoatRoughnessMap){const a={index:await t.processTextureAsync(e.clearcoatRoughnessMap),texCoord:e.clearcoatRoughnessMap.channel};t.applyTextureTransform(a,e.clearcoatRoughnessMap),n.clearcoatRoughnessTexture=a}if(e.clearcoatNormalMap){const a={index:await t.processTextureAsync(e.clearcoatNormalMap),texCoord:e.clearcoatNormalMap.channel};1!==e.clearcoatNormalScale.x&&(a.scale=e.clearcoatNormalScale.x),t.applyTextureTransform(a,e.clearcoatNormalMap),n.clearcoatNormalTexture=a}a.extensions=a.extensions||{},a.extensions[this.name]=n,s[this.name]=!0}}class y{constructor(e){this.writer=e,this.name="KHR_materials_dispersion"}async writeMaterialAsync(e,a){if(!e.isMeshPhysicalMaterial||0===e.dispersion)return;const t=this.writer.extensionsUsed,s={};s.dispersion=e.dispersion,a.extensions=a.extensions||{},a.extensions[this.name]=s,t[this.name]=!0}}class v{constructor(e){this.writer=e,this.name="KHR_materials_iridescence"}async writeMaterialAsync(e,a){if(!e.isMeshPhysicalMaterial||0===e.iridescence)return;const t=this.writer,s=t.extensionsUsed,n={};if(n.iridescenceFactor=e.iridescence,e.iridescenceMap){const a={index:await t.processTextureAsync(e.iridescenceMap),texCoord:e.iridescenceMap.channel};t.applyTextureTransform(a,e.iridescenceMap),n.iridescenceTexture=a}if(n.iridescenceIor=e.iridescenceIOR,n.iridescenceThicknessMinimum=e.iridescenceThicknessRange[0],n.iridescenceThicknessMaximum=e.iridescenceThicknessRange[1],e.iridescenceThicknessMap){const a={index:await t.processTextureAsync(e.iridescenceThicknessMap),texCoord:e.iridescenceThicknessMap.channel};t.applyTextureTransform(a,e.iridescenceThicknessMap),n.iridescenceThicknessTexture=a}a.extensions=a.extensions||{},a.extensions[this.name]=n,s[this.name]=!0}}class R{constructor(e){this.writer=e,this.name="KHR_materials_transmission"}async writeMaterialAsync(e,a){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const t=this.writer,s=t.extensionsUsed,n={};if(n.transmissionFactor=e.transmission,e.transmissionMap){const a={index:await t.processTextureAsync(e.transmissionMap),texCoord:e.transmissionMap.channel};t.applyTextureTransform(a,e.transmissionMap),n.transmissionTexture=a}a.extensions=a.extensions||{},a.extensions[this.name]=n,s[this.name]=!0}}class M{constructor(e){this.writer=e,this.name="KHR_materials_volume"}async writeMaterialAsync(e,a){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const t=this.writer,s=t.extensionsUsed,n={};if(n.thicknessFactor=e.thickness,e.thicknessMap){const a={index:await t.processTextureAsync(e.thicknessMap),texCoord:e.thicknessMap.channel};t.applyTextureTransform(a,e.thicknessMap),n.thicknessTexture=a}e.attenuationDistance!==1/0&&(n.attenuationDistance=e.attenuationDistance),n.attenuationColor=e.attenuationColor.toArray(),a.extensions=a.extensions||{},a.extensions[this.name]=n,s[this.name]=!0}}class E{constructor(e){this.writer=e,this.name="KHR_materials_ior"}async writeMaterialAsync(e,a){if(!e.isMeshPhysicalMaterial||1.5===e.ior)return;const t=this.writer.extensionsUsed,s={};s.ior=e.ior,a.extensions=a.extensions||{},a.extensions[this.name]=s,t[this.name]=!0}}class j{constructor(e){this.writer=e,this.name="KHR_materials_specular"}async writeMaterialAsync(e,a){if(!e.isMeshPhysicalMaterial||1===e.specularIntensity&&e.specularColor.equals(u)&&!e.specularIntensityMap&&!e.specularColorMap)return;const t=this.writer,s=t.extensionsUsed,n={};if(e.specularIntensityMap){const a={index:await t.processTextureAsync(e.specularIntensityMap),texCoord:e.specularIntensityMap.channel};t.applyTextureTransform(a,e.specularIntensityMap),n.specularTexture=a}if(e.specularColorMap){const a={index:await t.processTextureAsync(e.specularColorMap),texCoord:e.specularColorMap.channel};t.applyTextureTransform(a,e.specularColorMap),n.specularColorTexture=a}n.specularFactor=e.specularIntensity,n.specularColorFactor=e.specularColor.toArray(),a.extensions=a.extensions||{},a.extensions[this.name]=n,s[this.name]=!0}}class S{constructor(e){this.writer=e,this.name="KHR_materials_sheen"}async writeMaterialAsync(e,a){if(!e.isMeshPhysicalMaterial||0==e.sheen)return;const t=this.writer,s=t.extensionsUsed,n={};if(e.sheenRoughnessMap){const a={index:await t.processTextureAsync(e.sheenRoughnessMap),texCoord:e.sheenRoughnessMap.channel};t.applyTextureTransform(a,e.sheenRoughnessMap),n.sheenRoughnessTexture=a}if(e.sheenColorMap){const a={index:await t.processTextureAsync(e.sheenColorMap),texCoord:e.sheenColorMap.channel};t.applyTextureTransform(a,e.sheenColorMap),n.sheenColorTexture=a}n.sheenRoughnessFactor=e.sheenRoughness,n.sheenColorFactor=e.sheenColor.toArray(),a.extensions=a.extensions||{},a.extensions[this.name]=n,s[this.name]=!0}}class O{constructor(e){this.writer=e,this.name="KHR_materials_anisotropy"}async writeMaterialAsync(e,a){if(!e.isMeshPhysicalMaterial||0==e.anisotropy)return;const t=this.writer,s=t.extensionsUsed,n={};if(e.anisotropyMap){const a={index:await t.processTextureAsync(e.anisotropyMap)};t.applyTextureTransform(a,e.anisotropyMap),n.anisotropyTexture=a}n.anisotropyStrength=e.anisotropy,n.anisotropyRotation=e.anisotropyRotation,a.extensions=a.extensions||{},a.extensions[this.name]=n,s[this.name]=!0}}class F{constructor(e){this.writer=e,this.name="KHR_materials_emissive_strength"}async writeMaterialAsync(e,a){if(!e.isMeshStandardMaterial||1===e.emissiveIntensity)return;const t=this.writer.extensionsUsed,s={};s.emissiveStrength=e.emissiveIntensity,a.extensions=a.extensions||{},a.extensions[this.name]=s,t[this.name]=!0}}class C{constructor(e){this.writer=e,this.name="EXT_materials_bump"}async writeMaterialAsync(e,a){if(!e.isMeshStandardMaterial||1===e.bumpScale&&!e.bumpMap)return;const t=this.writer,s=t.extensionsUsed,n={};if(e.bumpMap){const a={index:await t.processTextureAsync(e.bumpMap),texCoord:e.bumpMap.channel};t.applyTextureTransform(a,e.bumpMap),n.bumpTexture=a}n.bumpFactor=e.bumpScale,a.extensions=a.extensions||{},a.extensions[this.name]=n,s[this.name]=!0}}class L{constructor(e){this.writer=e,this.name="EXT_mesh_gpu_instancing"}writeNode(e,a){if(!e.isInstancedMesh)return;const t=this.writer,n=e,i=new Float32Array(3*n.count),r=new Float32Array(4*n.count),o=new Float32Array(3*n.count),c=new s.kn4,b=new s.Pq0,l=new s.PTz,h=new s.Pq0;for(let e=0;e<n.count;e++)n.getMatrixAt(e,c),c.decompose(b,l,h),b.toArray(i,3*e),l.toArray(r,4*e),h.toArray(o,3*e);const p={TRANSLATION:t.processAccessor(new s.THS(i,3)),ROTATION:t.processAccessor(new s.THS(r,4)),SCALE:t.processAccessor(new s.THS(o,3))};n.instanceColor&&(p._COLOR_0=t.processAccessor(n.instanceColor)),a.extensions=a.extensions||{},a.extensions[this.name]={attributes:p},t.extensionsUsed[this.name]=!0,t.extensionsRequired[this.name]=!0}}i.Utils={insertKeyframe:function(e,a){const t=.001,s=e.getValueSize(),n=new e.TimeBufferType(e.times.length+1),i=new e.ValueBufferType(e.values.length+s),r=e.createInterpolant(new e.ValueBufferType(s));let o;if(0===e.times.length){n[0]=a;for(let e=0;e<s;e++)i[e]=0;o=0}else if(a<e.times[0]){if(Math.abs(e.times[0]-a)<t)return 0;n[0]=a,n.set(e.times,1),i.set(r.evaluate(a),0),i.set(e.values,s),o=0}else if(a>e.times[e.times.length-1]){if(Math.abs(e.times[e.times.length-1]-a)<t)return e.times.length-1;n[n.length-1]=a,n.set(e.times,0),i.set(e.values,0),i.set(r.evaluate(a),e.values.length),o=n.length-1}else for(let c=0;c<e.times.length;c++){if(Math.abs(e.times[c]-a)<t)return c;if(e.times[c]<a&&e.times[c+1]>a){n.set(e.times.slice(0,c+1),0),n[c+1]=a,n.set(e.times.slice(c+1),c+2),i.set(e.values.slice(0,(c+1)*s),0),i.set(r.evaluate(a),(c+1)*s),i.set(e.values.slice((c+1)*s),(c+2)*s),o=c+1;break}}return e.times=n,e.values=i,o},mergeMorphTargetTracks:function(e,a){const t=[],n={},i=e.tracks;for(let e=0;e<i.length;++e){let r=i[e];const o=s.Nwf.parseTrackName(r.name),c=s.Nwf.findNode(a,o.nodeName);if("morphTargetInfluences"!==o.propertyName||void 0===o.propertyIndex){t.push(r);continue}if(r.createInterpolant!==r.InterpolantFactoryMethodDiscrete&&r.createInterpolant!==r.InterpolantFactoryMethodLinear){if(r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),r=r.clone(),r.setInterpolation(s.PJ3)}const b=c.morphTargetInfluences.length,l=c.morphTargetDictionary[o.propertyIndex];if(void 0===l)throw new Error("THREE.GLTFExporter: Morph target name not found: "+o.propertyIndex);let h;if(void 0===n[c.uuid]){h=r.clone();const e=new h.ValueBufferType(b*h.times.length);for(let a=0;a<h.times.length;a++)e[a*b+l]=h.values[a];h.name=(o.nodeName||"")+".morphTargetInfluences",h.values=e,n[c.uuid]=h,t.push(h);continue}const p=r.createInterpolant(new r.ValueBufferType(1));h=n[c.uuid];for(let e=0;e<h.times.length;e++)h.values[e*b+l]=p.evaluate(h.times[e]);for(let e=0;e<r.times.length;e++){const a=this.insertKeyframe(h,r.times[e]);h.values[a*b+l]=r.values[e]}}return e.tracks=t,e},toFloat32BufferAttribute:function(e){const a=new s.THS(new Float32Array(e.count*e.itemSize),e.itemSize,!1);if(!e.normalized&&!e.isInterleavedBufferAttribute)return a.array.set(e.array),a;for(let t=0,s=e.count;t<s;t++)for(let s=0;s<e.itemSize;s++)a.setComponent(t,s,e.getComponent(t,s));return a}}},888:(e,a,t)=>{t.d(a,{B:()=>i});var s=t(922),n=t(566);class i extends s.aHM{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(e){return new h(e)}),this.register(function(e){return new p(e)}),this.register(function(e){return new A(e)}),this.register(function(e){return new k(e)}),this.register(function(e){return new y(e)}),this.register(function(e){return new u(e)}),this.register(function(e){return new f(e)}),this.register(function(e){return new m(e)}),this.register(function(e){return new g(e)}),this.register(function(e){return new l(e)}),this.register(function(e){return new x(e)}),this.register(function(e){return new d(e)}),this.register(function(e){return new w(e)}),this.register(function(e){return new T(e)}),this.register(function(e){return new c(e)}),this.register(function(e){return new v(e)}),this.register(function(e){return new R(e)})}load(e,a,t,n){const i=this;let r;if(""!==this.resourcePath)r=this.resourcePath;else if(""!==this.path){const a=s.r6x.extractUrlBase(e);r=s.r6x.resolveURL(a,this.path)}else r=s.r6x.extractUrlBase(e);this.manager.itemStart(e);const o=function(a){n?n(a):console.error(a),i.manager.itemError(e),i.manager.itemEnd(e)},c=new s.Y9S(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(t){try{i.parse(t,r,function(t){a(t),i.manager.itemEnd(e)},o)}catch(e){o(e)}},t,o)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,a,t,s){let n;const i={},r={},c=new TextDecoder;if("string"==typeof e)n=JSON.parse(e);else if(e instanceof ArrayBuffer)if(c.decode(new Uint8Array(e,0,4))===M){try{i[o.KHR_BINARY_GLTF]=new E(e)}catch(e){return void(s&&s(e))}n=JSON.parse(i[o.KHR_BINARY_GLTF].content)}else n=JSON.parse(c.decode(e));else n=e;if(void 0===n.asset||n.asset.version[0]<2)return void(s&&s(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const l=new X(n,{path:a||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let e=0;e<this.pluginCallbacks.length;e++){const a=this.pluginCallbacks[e](l);a.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),r[a.name]=a,i[a.name]=!0}if(n.extensionsUsed)for(let e=0;e<n.extensionsUsed.length;++e){const a=n.extensionsUsed[e],t=n.extensionsRequired||[];switch(a){case o.KHR_MATERIALS_UNLIT:i[a]=new b;break;case o.KHR_DRACO_MESH_COMPRESSION:i[a]=new j(n,this.dracoLoader);break;case o.KHR_TEXTURE_TRANSFORM:i[a]=new S;break;case o.KHR_MESH_QUANTIZATION:i[a]=new O;break;default:t.indexOf(a)>=0&&void 0===r[a]&&console.warn('THREE.GLTFLoader: Unknown extension "'+a+'".')}}l.setExtensions(i),l.setPlugins(r),l.parse(t,s)}parseAsync(e,a){const t=this;return new Promise(function(s,n){t.parse(e,a,s,n)})}}function r(){let e={};return{get:function(a){return e[a]},add:function(a,t){e[a]=t},remove:function(a){delete e[a]},removeAll:function(){e={}}}}const o={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class c{constructor(e){this.parser=e,this.name=o.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,a=this.parser.json.nodes||[];for(let t=0,s=a.length;t<s;t++){const s=a[t];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const a=this.parser,t="light:"+e;let n=a.cache.get(t);if(n)return n;const i=a.json,r=((i.extensions&&i.extensions[this.name]||{}).lights||[])[e];let o;const c=new s.Q1f(16777215);void 0!==r.color&&c.setRGB(r.color[0],r.color[1],r.color[2],s.Zr2);const b=void 0!==r.range?r.range:0;switch(r.type){case"directional":o=new s.ZyN(c),o.target.position.set(0,0,-1),o.add(o.target);break;case"point":o=new s.HiM(c),o.distance=b;break;case"spot":o=new s.nCl(c),o.distance=b,r.spot=r.spot||{},r.spot.innerConeAngle=void 0!==r.spot.innerConeAngle?r.spot.innerConeAngle:0,r.spot.outerConeAngle=void 0!==r.spot.outerConeAngle?r.spot.outerConeAngle:Math.PI/4,o.angle=r.spot.outerConeAngle,o.penumbra=1-r.spot.innerConeAngle/r.spot.outerConeAngle,o.target.position.set(0,0,-1),o.add(o.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+r.type)}return o.position.set(0,0,0),K(o,r),void 0!==r.intensity&&(o.intensity=r.intensity),o.name=a.createUniqueName(r.name||"light_"+e),n=Promise.resolve(o),a.cache.add(t,n),n}getDependency(e,a){if("light"===e)return this._loadLight(a)}createNodeAttachment(e){const a=this,t=this.parser,s=t.json.nodes[e],n=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===n?null:this._loadLight(n).then(function(e){return t._getNodeRef(a.cache,n,e)})}}class b{constructor(){this.name=o.KHR_MATERIALS_UNLIT}getMaterialType(){return s.V9B}extendParams(e,a,t){const n=[];e.color=new s.Q1f(1,1,1),e.opacity=1;const i=a.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){const a=i.baseColorFactor;e.color.setRGB(a[0],a[1],a[2],s.Zr2),e.opacity=a[3]}void 0!==i.baseColorTexture&&n.push(t.assignTexture(e,"map",i.baseColorTexture,s.er$))}return Promise.all(n)}}class l{constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,a){const t=this.parser.json.materials[e];if(!t.extensions||!t.extensions[this.name])return Promise.resolve();const s=t.extensions[this.name].emissiveStrength;return void 0!==s&&(a.emissiveIntensity=s),Promise.resolve()}}class h{constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const a=this.parser.json.materials[e];return a.extensions&&a.extensions[this.name]?s.uSd:null}extendMaterialParams(e,a){const t=this.parser,n=t.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const i=[],r=n.extensions[this.name];if(void 0!==r.clearcoatFactor&&(a.clearcoat=r.clearcoatFactor),void 0!==r.clearcoatTexture&&i.push(t.assignTexture(a,"clearcoatMap",r.clearcoatTexture)),void 0!==r.clearcoatRoughnessFactor&&(a.clearcoatRoughness=r.clearcoatRoughnessFactor),void 0!==r.clearcoatRoughnessTexture&&i.push(t.assignTexture(a,"clearcoatRoughnessMap",r.clearcoatRoughnessTexture)),void 0!==r.clearcoatNormalTexture&&(i.push(t.assignTexture(a,"clearcoatNormalMap",r.clearcoatNormalTexture)),void 0!==r.clearcoatNormalTexture.scale)){const e=r.clearcoatNormalTexture.scale;a.clearcoatNormalScale=new s.I9Y(e,e)}return Promise.all(i)}}class p{constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_DISPERSION}getMaterialType(e){const a=this.parser.json.materials[e];return a.extensions&&a.extensions[this.name]?s.uSd:null}extendMaterialParams(e,a){const t=this.parser.json.materials[e];if(!t.extensions||!t.extensions[this.name])return Promise.resolve();const s=t.extensions[this.name];return a.dispersion=void 0!==s.dispersion?s.dispersion:0,Promise.resolve()}}class d{constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const a=this.parser.json.materials[e];return a.extensions&&a.extensions[this.name]?s.uSd:null}extendMaterialParams(e,a){const t=this.parser,s=t.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const n=[],i=s.extensions[this.name];return void 0!==i.iridescenceFactor&&(a.iridescence=i.iridescenceFactor),void 0!==i.iridescenceTexture&&n.push(t.assignTexture(a,"iridescenceMap",i.iridescenceTexture)),void 0!==i.iridescenceIor&&(a.iridescenceIOR=i.iridescenceIor),void 0===a.iridescenceThicknessRange&&(a.iridescenceThicknessRange=[100,400]),void 0!==i.iridescenceThicknessMinimum&&(a.iridescenceThicknessRange[0]=i.iridescenceThicknessMinimum),void 0!==i.iridescenceThicknessMaximum&&(a.iridescenceThicknessRange[1]=i.iridescenceThicknessMaximum),void 0!==i.iridescenceThicknessTexture&&n.push(t.assignTexture(a,"iridescenceThicknessMap",i.iridescenceThicknessTexture)),Promise.all(n)}}class u{constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_SHEEN}getMaterialType(e){const a=this.parser.json.materials[e];return a.extensions&&a.extensions[this.name]?s.uSd:null}extendMaterialParams(e,a){const t=this.parser,n=t.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const i=[];a.sheenColor=new s.Q1f(0,0,0),a.sheenRoughness=0,a.sheen=1;const r=n.extensions[this.name];if(void 0!==r.sheenColorFactor){const e=r.sheenColorFactor;a.sheenColor.setRGB(e[0],e[1],e[2],s.Zr2)}return void 0!==r.sheenRoughnessFactor&&(a.sheenRoughness=r.sheenRoughnessFactor),void 0!==r.sheenColorTexture&&i.push(t.assignTexture(a,"sheenColorMap",r.sheenColorTexture,s.er$)),void 0!==r.sheenRoughnessTexture&&i.push(t.assignTexture(a,"sheenRoughnessMap",r.sheenRoughnessTexture)),Promise.all(i)}}class f{constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const a=this.parser.json.materials[e];return a.extensions&&a.extensions[this.name]?s.uSd:null}extendMaterialParams(e,a){const t=this.parser,s=t.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const n=[],i=s.extensions[this.name];return void 0!==i.transmissionFactor&&(a.transmission=i.transmissionFactor),void 0!==i.transmissionTexture&&n.push(t.assignTexture(a,"transmissionMap",i.transmissionTexture)),Promise.all(n)}}class m{constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_VOLUME}getMaterialType(e){const a=this.parser.json.materials[e];return a.extensions&&a.extensions[this.name]?s.uSd:null}extendMaterialParams(e,a){const t=this.parser,n=t.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const i=[],r=n.extensions[this.name];a.thickness=void 0!==r.thicknessFactor?r.thicknessFactor:0,void 0!==r.thicknessTexture&&i.push(t.assignTexture(a,"thicknessMap",r.thicknessTexture)),a.attenuationDistance=r.attenuationDistance||1/0;const o=r.attenuationColor||[1,1,1];return a.attenuationColor=(new s.Q1f).setRGB(o[0],o[1],o[2],s.Zr2),Promise.all(i)}}class g{constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_IOR}getMaterialType(e){const a=this.parser.json.materials[e];return a.extensions&&a.extensions[this.name]?s.uSd:null}extendMaterialParams(e,a){const t=this.parser.json.materials[e];if(!t.extensions||!t.extensions[this.name])return Promise.resolve();const s=t.extensions[this.name];return a.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class x{constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_SPECULAR}getMaterialType(e){const a=this.parser.json.materials[e];return a.extensions&&a.extensions[this.name]?s.uSd:null}extendMaterialParams(e,a){const t=this.parser,n=t.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const i=[],r=n.extensions[this.name];a.specularIntensity=void 0!==r.specularFactor?r.specularFactor:1,void 0!==r.specularTexture&&i.push(t.assignTexture(a,"specularIntensityMap",r.specularTexture));const o=r.specularColorFactor||[1,1,1];return a.specularColor=(new s.Q1f).setRGB(o[0],o[1],o[2],s.Zr2),void 0!==r.specularColorTexture&&i.push(t.assignTexture(a,"specularColorMap",r.specularColorTexture,s.er$)),Promise.all(i)}}class T{constructor(e){this.parser=e,this.name=o.EXT_MATERIALS_BUMP}getMaterialType(e){const a=this.parser.json.materials[e];return a.extensions&&a.extensions[this.name]?s.uSd:null}extendMaterialParams(e,a){const t=this.parser,s=t.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const n=[],i=s.extensions[this.name];return a.bumpScale=void 0!==i.bumpFactor?i.bumpFactor:1,void 0!==i.bumpTexture&&n.push(t.assignTexture(a,"bumpMap",i.bumpTexture)),Promise.all(n)}}class w{constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const a=this.parser.json.materials[e];return a.extensions&&a.extensions[this.name]?s.uSd:null}extendMaterialParams(e,a){const t=this.parser,s=t.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const n=[],i=s.extensions[this.name];return void 0!==i.anisotropyStrength&&(a.anisotropy=i.anisotropyStrength),void 0!==i.anisotropyRotation&&(a.anisotropyRotation=i.anisotropyRotation),void 0!==i.anisotropyTexture&&n.push(t.assignTexture(a,"anisotropyMap",i.anisotropyTexture)),Promise.all(n)}}class A{constructor(e){this.parser=e,this.name=o.KHR_TEXTURE_BASISU}loadTexture(e){const a=this.parser,t=a.json,s=t.textures[e];if(!s.extensions||!s.extensions[this.name])return null;const n=s.extensions[this.name],i=a.options.ktx2Loader;if(!i){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return a.loadTextureImage(e,n.source,i)}}class k{constructor(e){this.parser=e,this.name=o.EXT_TEXTURE_WEBP}loadTexture(e){const a=this.name,t=this.parser,s=t.json,n=s.textures[e];if(!n.extensions||!n.extensions[a])return null;const i=n.extensions[a],r=s.images[i.source];let o=t.textureLoader;if(r.uri){const e=t.options.manager.getHandler(r.uri);null!==e&&(o=e)}return t.loadTextureImage(e,i.source,o)}}class y{constructor(e){this.parser=e,this.name=o.EXT_TEXTURE_AVIF}loadTexture(e){const a=this.name,t=this.parser,s=t.json,n=s.textures[e];if(!n.extensions||!n.extensions[a])return null;const i=n.extensions[a],r=s.images[i.source];let o=t.textureLoader;if(r.uri){const e=t.options.manager.getHandler(r.uri);null!==e&&(o=e)}return t.loadTextureImage(e,i.source,o)}}class v{constructor(e){this.name=o.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const a=this.parser.json,t=a.bufferViews[e];if(t.extensions&&t.extensions[this.name]){const e=t.extensions[this.name],s=this.parser.getDependency("buffer",e.buffer),n=this.parser.options.meshoptDecoder;if(!n||!n.supported){if(a.extensionsRequired&&a.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const t=e.byteOffset||0,s=e.byteLength||0,i=e.count,r=e.byteStride,o=new Uint8Array(a,t,s);return n.decodeGltfBufferAsync?n.decodeGltfBufferAsync(i,r,o,e.mode,e.filter).then(function(e){return e.buffer}):n.ready.then(function(){const a=new ArrayBuffer(i*r);return n.decodeGltfBuffer(new Uint8Array(a),i,r,o,e.mode,e.filter),a})})}return null}}class R{constructor(e){this.name=o.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const a=this.parser.json,t=a.nodes[e];if(!t.extensions||!t.extensions[this.name]||void 0===t.mesh)return null;const n=a.meshes[t.mesh];for(const e of n.primitives)if(e.mode!==_.TRIANGLES&&e.mode!==_.TRIANGLE_STRIP&&e.mode!==_.TRIANGLE_FAN&&void 0!==e.mode)return null;const i=t.extensions[this.name].attributes,r=[],o={};for(const e in i)r.push(this.parser.getDependency("accessor",i[e]).then(a=>(o[e]=a,o[e])));return r.length<1?null:(r.push(this.parser.createNodeMesh(e)),Promise.all(r).then(e=>{const a=e.pop(),t=a.isGroup?a.children:[a],n=e[0].count,i=[];for(const e of t){const a=new s.kn4,t=new s.Pq0,r=new s.PTz,c=new s.Pq0(1,1,1),b=new s.ZLX(e.geometry,e.material,n);for(let e=0;e<n;e++)o.TRANSLATION&&t.fromBufferAttribute(o.TRANSLATION,e),o.ROTATION&&r.fromBufferAttribute(o.ROTATION,e),o.SCALE&&c.fromBufferAttribute(o.SCALE,e),b.setMatrixAt(e,a.compose(t,r,c));for(const a in o)if("_COLOR_0"===a){const e=o[a];b.instanceColor=new s.uWO(e.array,e.itemSize,e.normalized)}else"TRANSLATION"!==a&&"ROTATION"!==a&&"SCALE"!==a&&e.geometry.setAttribute(a,o[a]);s.B69.prototype.copy.call(b,e),this.parser.assignFinalMaterial(b),i.push(b)}return a.isGroup?(a.clear(),a.add(...i),a):i[0]}))}}const M="glTF";class E{constructor(e){this.name=o.KHR_BINARY_GLTF,this.content=null,this.body=null;const a=new DataView(e,0,12),t=new TextDecoder;if(this.header={magic:t.decode(new Uint8Array(e.slice(0,4))),version:a.getUint32(4,!0),length:a.getUint32(8,!0)},this.header.magic!==M)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const s=this.header.length-12,n=new DataView(e,12);let i=0;for(;i<s;){const a=n.getUint32(i,!0);i+=4;const s=n.getUint32(i,!0);if(i+=4,1313821514===s){const s=new Uint8Array(e,12+i,a);this.content=t.decode(s)}else if(5130562===s){const t=12+i;this.body=e.slice(t,t+a)}i+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class j{constructor(e,a){if(!a)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=o.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=a,this.dracoLoader.preload()}decodePrimitive(e,a){const t=this.json,n=this.dracoLoader,i=e.extensions[this.name].bufferView,r=e.extensions[this.name].attributes,o={},c={},b={};for(const e in r){const a=N[e]||e.toLowerCase();o[a]=r[e]}for(const a in e.attributes){const s=N[a]||a.toLowerCase();if(void 0!==r[a]){const n=t.accessors[e.attributes[a]],i=P[n.componentType];b[s]=i.name,c[s]=!0===n.normalized}}return a.getDependency("bufferView",i).then(function(e){return new Promise(function(a,t){n.decodeDracoFile(e,function(e){for(const a in e.attributes){const t=e.attributes[a],s=c[a];void 0!==s&&(t.normalized=s)}a(e)},o,b,s.Zr2,t)})})}}class S{constructor(){this.name=o.KHR_TEXTURE_TRANSFORM}extendTexture(e,a){return void 0!==a.texCoord&&a.texCoord!==e.channel||void 0!==a.offset||void 0!==a.rotation||void 0!==a.scale?(e=e.clone(),void 0!==a.texCoord&&(e.channel=a.texCoord),void 0!==a.offset&&e.offset.fromArray(a.offset),void 0!==a.rotation&&(e.rotation=a.rotation),void 0!==a.scale&&e.repeat.fromArray(a.scale),e.needsUpdate=!0,e):e}}class O{constructor(){this.name=o.KHR_MESH_QUANTIZATION}}class F extends s.lGw{constructor(e,a,t,s){super(e,a,t,s)}copySampleValue_(e){const a=this.resultBuffer,t=this.sampleValues,s=this.valueSize,n=e*s*3+s;for(let e=0;e!==s;e++)a[e]=t[n+e];return a}interpolate_(e,a,t,s){const n=this.resultBuffer,i=this.sampleValues,r=this.valueSize,o=2*r,c=3*r,b=s-a,l=(t-a)/b,h=l*l,p=h*l,d=e*c,u=d-c,f=-2*p+3*h,m=p-h,g=1-f,x=m-h+l;for(let e=0;e!==r;e++){const a=i[u+e+r],t=i[u+e+o]*b,s=i[d+e+r],c=i[d+e]*b;n[e]=g*a+x*t+f*s+m*c}return n}}const C=new s.PTz;class L extends F{interpolate_(e,a,t,s){const n=super.interpolate_(e,a,t,s);return C.fromArray(n).normalize().toArray(n),n}}const _={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},P={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},H={9728:s.hxR,9729:s.k6q,9984:s.pHI,9985:s.kRr,9986:s.Cfg,9987:s.$_I},I={33071:s.ghU,33648:s.kTW,10497:s.GJx},G={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},N={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},z={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},D={CUBICSPLINE:void 0,LINEAR:s.PJ3,STEP:s.ljd};function U(e){return void 0===e.DefaultMaterial&&(e.DefaultMaterial=new s._4j({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:s.hB5})),e.DefaultMaterial}function q(e,a,t){for(const s in t.extensions)void 0===e[s]&&(a.userData.gltfExtensions=a.userData.gltfExtensions||{},a.userData.gltfExtensions[s]=t.extensions[s])}function K(e,a){void 0!==a.extras&&("object"==typeof a.extras?Object.assign(e.userData,a.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+a.extras))}function B(e,a){if(e.updateMorphTargets(),void 0!==a.weights)for(let t=0,s=a.weights.length;t<s;t++)e.morphTargetInfluences[t]=a.weights[t];if(a.extras&&Array.isArray(a.extras.targetNames)){const t=a.extras.targetNames;if(e.morphTargetInfluences.length===t.length){e.morphTargetDictionary={};for(let a=0,s=t.length;a<s;a++)e.morphTargetDictionary[t[a]]=a}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function V(e){let a;const t=e.extensions&&e.extensions[o.KHR_DRACO_MESH_COMPRESSION];if(a=t?"draco:"+t.bufferView+":"+t.indices+":"+Q(t.attributes):e.indices+":"+Q(e.attributes)+":"+e.mode,void 0!==e.targets)for(let t=0,s=e.targets.length;t<s;t++)a+=":"+Q(e.targets[t]);return a}function Q(e){let a="";const t=Object.keys(e).sort();for(let s=0,n=t.length;s<n;s++)a+=t[s]+":"+e[t[s]]+";";return a}function W(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const J=new s.kn4;class X{constructor(e={},a={}){this.json=e,this.extensions={},this.plugins={},this.options=a,this.cache=new r,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let t=!1,n=-1,i=!1,o=-1;if("undefined"!=typeof navigator){const e=navigator.userAgent;t=!0===/^((?!chrome|android).)*safari/i.test(e);const a=e.match(/Version\/(\d+)/);n=t&&a?parseInt(a[1],10):-1,i=e.indexOf("Firefox")>-1,o=i?e.match(/Firefox\/([0-9]+)\./)[1]:-1}"undefined"==typeof createImageBitmap||t&&n<17||i&&o<98?this.textureLoader=new s.Tap(this.options.manager):this.textureLoader=new s.Kzg(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new s.Y9S(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,a){const t=this,s=this.json,n=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(e){return e._markDefs&&e._markDefs()}),Promise.all(this._invokeAll(function(e){return e.beforeRoot&&e.beforeRoot()})).then(function(){return Promise.all([t.getDependencies("scene"),t.getDependencies("animation"),t.getDependencies("camera")])}).then(function(a){const i={scene:a[0][s.scene||0],scenes:a[0],animations:a[1],cameras:a[2],asset:s.asset,parser:t,userData:{}};return q(n,i,s),K(i,s),Promise.all(t._invokeAll(function(e){return e.afterRoot&&e.afterRoot(i)})).then(function(){for(const e of i.scenes)e.updateMatrixWorld();e(i)})}).catch(a)}_markDefs(){const e=this.json.nodes||[],a=this.json.skins||[],t=this.json.meshes||[];for(let t=0,s=a.length;t<s;t++){const s=a[t].joints;for(let a=0,t=s.length;a<t;a++)e[s[a]].isBone=!0}for(let a=0,s=e.length;a<s;a++){const s=e[a];void 0!==s.mesh&&(this._addNodeRef(this.meshCache,s.mesh),void 0!==s.skin&&(t[s.mesh].isSkinnedMesh=!0)),void 0!==s.camera&&this._addNodeRef(this.cameraCache,s.camera)}}_addNodeRef(e,a){void 0!==a&&(void 0===e.refs[a]&&(e.refs[a]=e.uses[a]=0),e.refs[a]++)}_getNodeRef(e,a,t){if(e.refs[a]<=1)return t;const s=t.clone(),n=(e,a)=>{const t=this.associations.get(e);null!=t&&this.associations.set(a,t);for(const[t,s]of e.children.entries())n(s,a.children[t])};return n(t,s),s.name+="_instance_"+e.uses[a]++,s}_invokeOne(e){const a=Object.values(this.plugins);a.push(this);for(let t=0;t<a.length;t++){const s=e(a[t]);if(s)return s}return null}_invokeAll(e){const a=Object.values(this.plugins);a.unshift(this);const t=[];for(let s=0;s<a.length;s++){const n=e(a[s]);n&&t.push(n)}return t}getDependency(e,a){const t=e+":"+a;let s=this.cache.get(t);if(!s){switch(e){case"scene":s=this.loadScene(a);break;case"node":s=this._invokeOne(function(e){return e.loadNode&&e.loadNode(a)});break;case"mesh":s=this._invokeOne(function(e){return e.loadMesh&&e.loadMesh(a)});break;case"accessor":s=this.loadAccessor(a);break;case"bufferView":s=this._invokeOne(function(e){return e.loadBufferView&&e.loadBufferView(a)});break;case"buffer":s=this.loadBuffer(a);break;case"material":s=this._invokeOne(function(e){return e.loadMaterial&&e.loadMaterial(a)});break;case"texture":s=this._invokeOne(function(e){return e.loadTexture&&e.loadTexture(a)});break;case"skin":s=this.loadSkin(a);break;case"animation":s=this._invokeOne(function(e){return e.loadAnimation&&e.loadAnimation(a)});break;case"camera":s=this.loadCamera(a);break;default:if(s=this._invokeOne(function(t){return t!=this&&t.getDependency&&t.getDependency(e,a)}),!s)throw new Error("Unknown type: "+e)}this.cache.add(t,s)}return s}getDependencies(e){let a=this.cache.get(e);if(!a){const t=this,s=this.json[e+("mesh"===e?"es":"s")]||[];a=Promise.all(s.map(function(a,s){return t.getDependency(e,s)})),this.cache.add(e,a)}return a}loadBuffer(e){const a=this.json.buffers[e],t=this.fileLoader;if(a.type&&"arraybuffer"!==a.type)throw new Error("THREE.GLTFLoader: "+a.type+" buffer type is not supported.");if(void 0===a.uri&&0===e)return Promise.resolve(this.extensions[o.KHR_BINARY_GLTF].body);const n=this.options;return new Promise(function(e,i){t.load(s.r6x.resolveURL(a.uri,n.path),e,void 0,function(){i(new Error('THREE.GLTFLoader: Failed to load buffer "'+a.uri+'".'))})})}loadBufferView(e){const a=this.json.bufferViews[e];return this.getDependency("buffer",a.buffer).then(function(e){const t=a.byteLength||0,s=a.byteOffset||0;return e.slice(s,s+t)})}loadAccessor(e){const a=this,t=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse){const e=G[n.type],a=P[n.componentType],t=!0===n.normalized,i=new a(n.count*e);return Promise.resolve(new s.THS(i,e,t))}const i=[];return void 0!==n.bufferView?i.push(this.getDependency("bufferView",n.bufferView)):i.push(null),void 0!==n.sparse&&(i.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(i).then(function(e){const i=e[0],r=G[n.type],o=P[n.componentType],c=o.BYTES_PER_ELEMENT,b=c*r,l=n.byteOffset||0,h=void 0!==n.bufferView?t.bufferViews[n.bufferView].byteStride:void 0,p=!0===n.normalized;let d,u;if(h&&h!==b){const e=Math.floor(l/h),t="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+e+":"+n.count;let b=a.cache.get(t);b||(d=new o(i,e*h,n.count*h/c),b=new s.eB$(d,h/c),a.cache.add(t,b)),u=new s.eHs(b,r,l%h/c,p)}else d=null===i?new o(n.count*r):new o(i,l,n.count*r),u=new s.THS(d,r,p);if(void 0!==n.sparse){const a=G.SCALAR,t=P[n.sparse.indices.componentType],c=n.sparse.indices.byteOffset||0,b=n.sparse.values.byteOffset||0,l=new t(e[1],c,n.sparse.count*a),h=new o(e[2],b,n.sparse.count*r);null!==i&&(u=new s.THS(u.array.slice(),u.itemSize,u.normalized)),u.normalized=!1;for(let e=0,a=l.length;e<a;e++){const a=l[e];if(u.setX(a,h[e*r]),r>=2&&u.setY(a,h[e*r+1]),r>=3&&u.setZ(a,h[e*r+2]),r>=4&&u.setW(a,h[e*r+3]),r>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}u.normalized=p}return u})}loadTexture(e){const a=this.json,t=this.options,s=a.textures[e].source,n=a.images[s];let i=this.textureLoader;if(n.uri){const e=t.manager.getHandler(n.uri);null!==e&&(i=e)}return this.loadTextureImage(e,s,i)}loadTextureImage(e,a,t){const n=this,i=this.json,r=i.textures[e],o=i.images[a],c=(o.uri||o.bufferView)+":"+r.sampler;if(this.textureCache[c])return this.textureCache[c];const b=this.loadImageSource(a,t).then(function(a){a.flipY=!1,a.name=r.name||o.name||"",""===a.name&&"string"==typeof o.uri&&!1===o.uri.startsWith("data:image/")&&(a.name=o.uri);const t=(i.samplers||{})[r.sampler]||{};return a.magFilter=H[t.magFilter]||s.k6q,a.minFilter=H[t.minFilter]||s.$_I,a.wrapS=I[t.wrapS]||s.GJx,a.wrapT=I[t.wrapT]||s.GJx,a.generateMipmaps=!a.isCompressedTexture&&a.minFilter!==s.hxR&&a.minFilter!==s.k6q,n.associations.set(a,{textures:e}),a}).catch(function(){return null});return this.textureCache[c]=b,b}loadImageSource(e,a){const t=this.json,n=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(e=>e.clone());const i=t.images[e],r=self.URL||self.webkitURL;let o=i.uri||"",c=!1;if(void 0!==i.bufferView)o=this.getDependency("bufferView",i.bufferView).then(function(e){c=!0;const a=new Blob([e],{type:i.mimeType});return o=r.createObjectURL(a),o});else if(void 0===i.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const b=Promise.resolve(o).then(function(e){return new Promise(function(t,i){let r=t;!0===a.isImageBitmapLoader&&(r=function(e){const a=new s.gPd(e);a.needsUpdate=!0,t(a)}),a.load(s.r6x.resolveURL(e,n.path),r,void 0,i)})}).then(function(e){var a;return!0===c&&r.revokeObjectURL(o),K(e,i),e.userData.mimeType=i.mimeType||((a=i.uri).search(/\.jpe?g($|\?)/i)>0||0===a.search(/^data\:image\/jpeg/)?"image/jpeg":a.search(/\.webp($|\?)/i)>0||0===a.search(/^data\:image\/webp/)?"image/webp":a.search(/\.ktx2($|\?)/i)>0||0===a.search(/^data\:image\/ktx2/)?"image/ktx2":"image/png"),e}).catch(function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",o),e});return this.sourceCache[e]=b,b}assignTexture(e,a,t,s){const n=this;return this.getDependency("texture",t.index).then(function(i){if(!i)return null;if(void 0!==t.texCoord&&t.texCoord>0&&((i=i.clone()).channel=t.texCoord),n.extensions[o.KHR_TEXTURE_TRANSFORM]){const e=void 0!==t.extensions?t.extensions[o.KHR_TEXTURE_TRANSFORM]:void 0;if(e){const a=n.associations.get(i);i=n.extensions[o.KHR_TEXTURE_TRANSFORM].extendTexture(i,e),n.associations.set(i,a)}}return void 0!==s&&(i.colorSpace=s),e[a]=i,i})}assignFinalMaterial(e){const a=e.geometry;let t=e.material;const n=void 0===a.attributes.tangent,i=void 0!==a.attributes.color,r=void 0===a.attributes.normal;if(e.isPoints){const e="PointsMaterial:"+t.uuid;let a=this.cache.get(e);a||(a=new s.BH$,s.imn.prototype.copy.call(a,t),a.color.copy(t.color),a.map=t.map,a.sizeAttenuation=!1,this.cache.add(e,a)),t=a}else if(e.isLine){const e="LineBasicMaterial:"+t.uuid;let a=this.cache.get(e);a||(a=new s.mrM,s.imn.prototype.copy.call(a,t),a.color.copy(t.color),a.map=t.map,this.cache.add(e,a)),t=a}if(n||i||r){let e="ClonedMaterial:"+t.uuid+":";n&&(e+="derivative-tangents:"),i&&(e+="vertex-colors:"),r&&(e+="flat-shading:");let a=this.cache.get(e);a||(a=t.clone(),i&&(a.vertexColors=!0),r&&(a.flatShading=!0),n&&(a.normalScale&&(a.normalScale.y*=-1),a.clearcoatNormalScale&&(a.clearcoatNormalScale.y*=-1)),this.cache.add(e,a),this.associations.set(a,this.associations.get(t))),t=a}e.material=t}getMaterialType(){return s._4j}loadMaterial(e){const a=this,t=this.json,n=this.extensions,i=t.materials[e];let r;const c={},b=[];if((i.extensions||{})[o.KHR_MATERIALS_UNLIT]){const e=n[o.KHR_MATERIALS_UNLIT];r=e.getMaterialType(),b.push(e.extendParams(c,i,a))}else{const t=i.pbrMetallicRoughness||{};if(c.color=new s.Q1f(1,1,1),c.opacity=1,Array.isArray(t.baseColorFactor)){const e=t.baseColorFactor;c.color.setRGB(e[0],e[1],e[2],s.Zr2),c.opacity=e[3]}void 0!==t.baseColorTexture&&b.push(a.assignTexture(c,"map",t.baseColorTexture,s.er$)),c.metalness=void 0!==t.metallicFactor?t.metallicFactor:1,c.roughness=void 0!==t.roughnessFactor?t.roughnessFactor:1,void 0!==t.metallicRoughnessTexture&&(b.push(a.assignTexture(c,"metalnessMap",t.metallicRoughnessTexture)),b.push(a.assignTexture(c,"roughnessMap",t.metallicRoughnessTexture))),r=this._invokeOne(function(a){return a.getMaterialType&&a.getMaterialType(e)}),b.push(Promise.all(this._invokeAll(function(a){return a.extendMaterialParams&&a.extendMaterialParams(e,c)})))}!0===i.doubleSided&&(c.side=s.$EB);const l=i.alphaMode||"OPAQUE";if("BLEND"===l?(c.transparent=!0,c.depthWrite=!1):(c.transparent=!1,"MASK"===l&&(c.alphaTest=void 0!==i.alphaCutoff?i.alphaCutoff:.5)),void 0!==i.normalTexture&&r!==s.V9B&&(b.push(a.assignTexture(c,"normalMap",i.normalTexture)),c.normalScale=new s.I9Y(1,1),void 0!==i.normalTexture.scale)){const e=i.normalTexture.scale;c.normalScale.set(e,e)}if(void 0!==i.occlusionTexture&&r!==s.V9B&&(b.push(a.assignTexture(c,"aoMap",i.occlusionTexture)),void 0!==i.occlusionTexture.strength&&(c.aoMapIntensity=i.occlusionTexture.strength)),void 0!==i.emissiveFactor&&r!==s.V9B){const e=i.emissiveFactor;c.emissive=(new s.Q1f).setRGB(e[0],e[1],e[2],s.Zr2)}return void 0!==i.emissiveTexture&&r!==s.V9B&&b.push(a.assignTexture(c,"emissiveMap",i.emissiveTexture,s.er$)),Promise.all(b).then(function(){const t=new r(c);return i.name&&(t.name=i.name),K(t,i),a.associations.set(t,{materials:e}),i.extensions&&q(n,t,i),t})}createUniqueName(e){const a=s.Nwf.sanitizeNodeName(e||"");return a in this.nodeNamesUsed?a+"_"+ ++this.nodeNamesUsed[a]:(this.nodeNamesUsed[a]=0,a)}loadGeometries(e){const a=this,t=this.extensions,n=this.primitiveCache;function i(e){return t[o.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,a).then(function(t){return Y(t,e,a)})}const r=[];for(let t=0,c=e.length;t<c;t++){const c=e[t],b=V(c),l=n[b];if(l)r.push(l.promise);else{let e;e=c.extensions&&c.extensions[o.KHR_DRACO_MESH_COMPRESSION]?i(c):Y(new s.LoY,c,a),n[b]={primitive:c,promise:e},r.push(e)}}return Promise.all(r)}loadMesh(e){const a=this,t=this.json,i=this.extensions,r=t.meshes[e],o=r.primitives,c=[];for(let e=0,a=o.length;e<a;e++){const a=void 0===o[e].material?U(this.cache):this.getDependency("material",o[e].material);c.push(a)}return c.push(a.loadGeometries(o)),Promise.all(c).then(function(t){const c=t.slice(0,t.length-1),b=t[t.length-1],l=[];for(let t=0,h=b.length;t<h;t++){const h=b[t],p=o[t];let d;const u=c[t];if(p.mode===_.TRIANGLES||p.mode===_.TRIANGLE_STRIP||p.mode===_.TRIANGLE_FAN||void 0===p.mode)d=!0===r.isSkinnedMesh?new s.I46(h,u):new s.eaF(h,u),!0===d.isSkinnedMesh&&d.normalizeSkinWeights(),p.mode===_.TRIANGLE_STRIP?d.geometry=(0,n._c)(d.geometry,s.O49):p.mode===_.TRIANGLE_FAN&&(d.geometry=(0,n._c)(d.geometry,s.rYR));else if(p.mode===_.LINES)d=new s.DXC(h,u);else if(p.mode===_.LINE_STRIP)d=new s.N1A(h,u);else if(p.mode===_.LINE_LOOP)d=new s.FCc(h,u);else{if(p.mode!==_.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+p.mode);d=new s.ONl(h,u)}Object.keys(d.geometry.morphAttributes).length>0&&B(d,r),d.name=a.createUniqueName(r.name||"mesh_"+e),K(d,r),p.extensions&&q(i,d,p),a.assignFinalMaterial(d),l.push(d)}for(let t=0,s=l.length;t<s;t++)a.associations.set(l[t],{meshes:e,primitives:t});if(1===l.length)return r.extensions&&q(i,l[0],r),l[0];const h=new s.YJl;r.extensions&&q(i,h,r),a.associations.set(h,{meshes:e});for(let e=0,a=l.length;e<a;e++)h.add(l[e]);return h})}loadCamera(e){let a;const t=this.json.cameras[e],n=t[t.type];if(n)return"perspective"===t.type?a=new s.ubm(s.cj9.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===t.type&&(a=new s.qUd(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),t.name&&(a.name=this.createUniqueName(t.name)),K(a,t),Promise.resolve(a);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const a=this.json.skins[e],t=[];for(let e=0,s=a.joints.length;e<s;e++)t.push(this._loadNodeShallow(a.joints[e]));return void 0!==a.inverseBindMatrices?t.push(this.getDependency("accessor",a.inverseBindMatrices)):t.push(null),Promise.all(t).then(function(e){const t=e.pop(),n=e,i=[],r=[];for(let e=0,o=n.length;e<o;e++){const o=n[e];if(o){i.push(o);const a=new s.kn4;null!==t&&a.fromArray(t.array,16*e),r.push(a)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',a.joints[e])}return new s.EAD(i,r)})}loadAnimation(e){const a=this.json,t=this,n=a.animations[e],i=n.name?n.name:"animation_"+e,r=[],o=[],c=[],b=[],l=[];for(let e=0,a=n.channels.length;e<a;e++){const a=n.channels[e],t=n.samplers[a.sampler],s=a.target,i=s.node,h=void 0!==n.parameters?n.parameters[t.input]:t.input,p=void 0!==n.parameters?n.parameters[t.output]:t.output;void 0!==s.node&&(r.push(this.getDependency("node",i)),o.push(this.getDependency("accessor",h)),c.push(this.getDependency("accessor",p)),b.push(t),l.push(s))}return Promise.all([Promise.all(r),Promise.all(o),Promise.all(c),Promise.all(b),Promise.all(l)]).then(function(e){const a=e[0],n=e[1],r=e[2],o=e[3],c=e[4],b=[];for(let e=0,s=a.length;e<s;e++){const s=a[e],i=n[e],l=r[e],h=o[e],p=c[e];if(void 0===s)continue;s.updateMatrix&&s.updateMatrix();const d=t._createAnimationTracks(s,i,l,h,p);if(d)for(let e=0;e<d.length;e++)b.push(d[e])}return new s.tz3(i,void 0,b)})}createNodeMesh(e){const a=this.json,t=this,s=a.nodes[e];return void 0===s.mesh?null:t.getDependency("mesh",s.mesh).then(function(e){const a=t._getNodeRef(t.meshCache,s.mesh,e);return void 0!==s.weights&&a.traverse(function(e){if(e.isMesh)for(let a=0,t=s.weights.length;a<t;a++)e.morphTargetInfluences[a]=s.weights[a]}),a})}loadNode(e){const a=this,t=this.json.nodes[e],s=a._loadNodeShallow(e),n=[],i=t.children||[];for(let e=0,t=i.length;e<t;e++)n.push(a.getDependency("node",i[e]));const r=void 0===t.skin?Promise.resolve(null):a.getDependency("skin",t.skin);return Promise.all([s,Promise.all(n),r]).then(function(e){const a=e[0],t=e[1],s=e[2];null!==s&&a.traverse(function(e){e.isSkinnedMesh&&e.bind(s,J)});for(let e=0,s=t.length;e<s;e++)a.add(t[e]);return a})}_loadNodeShallow(e){const a=this.json,t=this.extensions,n=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const i=a.nodes[e],r=i.name?n.createUniqueName(i.name):"",o=[],c=n._invokeOne(function(a){return a.createNodeMesh&&a.createNodeMesh(e)});return c&&o.push(c),void 0!==i.camera&&o.push(n.getDependency("camera",i.camera).then(function(e){return n._getNodeRef(n.cameraCache,i.camera,e)})),n._invokeAll(function(a){return a.createNodeAttachment&&a.createNodeAttachment(e)}).forEach(function(e){o.push(e)}),this.nodeCache[e]=Promise.all(o).then(function(a){let o;if(o=!0===i.isBone?new s.$Kf:a.length>1?new s.YJl:1===a.length?a[0]:new s.B69,o!==a[0])for(let e=0,t=a.length;e<t;e++)o.add(a[e]);if(i.name&&(o.userData.name=i.name,o.name=r),K(o,i),i.extensions&&q(t,o,i),void 0!==i.matrix){const e=new s.kn4;e.fromArray(i.matrix),o.applyMatrix4(e)}else void 0!==i.translation&&o.position.fromArray(i.translation),void 0!==i.rotation&&o.quaternion.fromArray(i.rotation),void 0!==i.scale&&o.scale.fromArray(i.scale);if(n.associations.has(o)){if(void 0!==i.mesh&&n.meshCache.refs[i.mesh]>1){const e=n.associations.get(o);n.associations.set(o,{...e})}}else n.associations.set(o,{});return n.associations.get(o).nodes=e,o}),this.nodeCache[e]}loadScene(e){const a=this.extensions,t=this.json.scenes[e],n=this,i=new s.YJl;t.name&&(i.name=n.createUniqueName(t.name)),K(i,t),t.extensions&&q(a,i,t);const r=t.nodes||[],o=[];for(let e=0,a=r.length;e<a;e++)o.push(n.getDependency("node",r[e]));return Promise.all(o).then(function(e){for(let a=0,t=e.length;a<t;a++)i.add(e[a]);return n.associations=(e=>{const a=new Map;for(const[e,t]of n.associations)(e instanceof s.imn||e instanceof s.gPd)&&a.set(e,t);return e.traverse(e=>{const t=n.associations.get(e);null!=t&&a.set(e,t)}),a})(i),i})}_createAnimationTracks(e,a,t,n,i){const r=[],o=e.name?e.name:e.uuid,c=[];let b;switch(z[i.path]===z.weights?e.traverse(function(e){e.morphTargetInfluences&&c.push(e.name?e.name:e.uuid)}):c.push(o),z[i.path]){case z.weights:b=s.Hit;break;case z.rotation:b=s.MBL;break;case z.translation:case z.scale:b=s.RiT;break;default:b=1===t.itemSize?s.Hit:s.RiT}const l=void 0!==n.interpolation?D[n.interpolation]:s.PJ3,h=this._getArrayFromAccessor(t);for(let e=0,t=c.length;e<t;e++){const t=new b(c[e]+"."+z[i.path],a.array,h,l);"CUBICSPLINE"===n.interpolation&&this._createCubicSplineTrackInterpolant(t),r.push(t)}return r}_getArrayFromAccessor(e){let a=e.array;if(e.normalized){const e=W(a.constructor),t=new Float32Array(a.length);for(let s=0,n=a.length;s<n;s++)t[s]=a[s]*e;a=t}return a}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(e){return new(this instanceof s.MBL?L:F)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function Y(e,a,t){const n=a.attributes,i=[];function r(a,s){return t.getDependency("accessor",a).then(function(a){e.setAttribute(s,a)})}for(const a in n){const t=N[a]||a.toLowerCase();t in e.attributes||i.push(r(n[a],t))}if(void 0!==a.indices&&!e.index){const s=t.getDependency("accessor",a.indices).then(function(a){e.setIndex(a)});i.push(s)}return s.ppV.workingColorSpace!==s.Zr2&&"COLOR_0"in n&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${s.ppV.workingColorSpace}" not supported.`),K(e,a),function(e,a,t){const n=a.attributes,i=new s.NRn;if(void 0===n.POSITION)return;{const e=t.json.accessors[n.POSITION],a=e.min,r=e.max;if(void 0===a||void 0===r)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(i.set(new s.Pq0(a[0],a[1],a[2]),new s.Pq0(r[0],r[1],r[2])),e.normalized){const a=W(P[e.componentType]);i.min.multiplyScalar(a),i.max.multiplyScalar(a)}}const r=a.targets;if(void 0!==r){const e=new s.Pq0,a=new s.Pq0;for(let s=0,n=r.length;s<n;s++){const n=r[s];if(void 0!==n.POSITION){const s=t.json.accessors[n.POSITION],i=s.min,r=s.max;if(void 0!==i&&void 0!==r){if(a.setX(Math.max(Math.abs(i[0]),Math.abs(r[0]))),a.setY(Math.max(Math.abs(i[1]),Math.abs(r[1]))),a.setZ(Math.max(Math.abs(i[2]),Math.abs(r[2]))),s.normalized){const e=W(P[s.componentType]);a.multiplyScalar(e)}e.max(a)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(e)}e.boundingBox=i;const o=new s.iyt;i.getCenter(o.center),o.radius=i.min.distanceTo(i.max)/2,e.boundingSphere=o}(e,a,t),Promise.all(i).then(function(){return void 0!==a.targets?function(e,a,t){let s=!1,n=!1,i=!1;for(let e=0,t=a.length;e<t;e++){const t=a[e];if(void 0!==t.POSITION&&(s=!0),void 0!==t.NORMAL&&(n=!0),void 0!==t.COLOR_0&&(i=!0),s&&n&&i)break}if(!s&&!n&&!i)return Promise.resolve(e);const r=[],o=[],c=[];for(let b=0,l=a.length;b<l;b++){const l=a[b];if(s){const a=void 0!==l.POSITION?t.getDependency("accessor",l.POSITION):e.attributes.position;r.push(a)}if(n){const a=void 0!==l.NORMAL?t.getDependency("accessor",l.NORMAL):e.attributes.normal;o.push(a)}if(i){const a=void 0!==l.COLOR_0?t.getDependency("accessor",l.COLOR_0):e.attributes.color;c.push(a)}}return Promise.all([Promise.all(r),Promise.all(o),Promise.all(c)]).then(function(a){const t=a[0],r=a[1],o=a[2];return s&&(e.morphAttributes.position=t),n&&(e.morphAttributes.normal=r),i&&(e.morphAttributes.color=o),e.morphTargetsRelative=!0,e})}(e,a.targets,t):e})}}}]);