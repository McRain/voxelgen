(()=>{"use strict";var e,t={767:(e,t,n)=>{var o={};n.r(o),n.d(o,{user:()=>l});var r=n(751),i=n(302),a=n(953);i.A.default||i.A;const l=(0,a.Kh)({id:"mee"});var s=n(641);const d={class:"app-container"};var c=n(33);const u={class:"app-container"},p={key:0,class:"file-upload-panel"},h={class:"file-input-container"},f={key:0,class:"file-name"},w={key:0,class:"upload-status"},m={key:1,class:"uploaded-files"},v=["onClick"],y={class:"control-panel"},b={class:"buttons-group"},g={class:"sliders-group"},k={class:"slider-container"},x={class:"slider-container"},B={class:"slider-container"},S={class:"slider-container"};var L=n(888),F=n(51),V=n(922),P=n(437),M=n(409),E=n(24),C=n(912);let A,O,j,W,z,I,T;V.eaF.prototype.raycast=M.zQ,V.LoY.prototype.computeBoundsTree=M.LO,V.LoY.prototype.disposeBoundsTree=M.je,V.$Ed.prototype.computeBoundsTree=M.K5,V.$Ed.prototype.disposeBoundsTree=M.Of,V.$Ed.prototype.raycast=M.zQ;let _,Q=!1,R=null,U={model:"Torus Knot",scale:1.5,resolution:40,solid:!1,displayMesh:!0,displayBounds:!1,insideOnly:!1,rebuild:()=>Q=!0};const H={},$=new V._4j({transparent:!0,opacity:1});function G(){if(requestAnimationFrame(G),j.updateMatrixWorld(!0),Q&&(R=function*(){const e=U.resolution,t=e**3,n=U.scale,o=n/e,r=new V.Q1f(16777215),i=new V.Q1f(16761095).convertSRGBToLinear();z&&z.instanceMatrix.count!==t&&(z.material.dispose(),z.dispose(),z.parent.remove(z),z=null);const{model:a,bvh:l}=_;if(!a)return;z||(z=new V.ZLX(new C.j(1,1,1,4,.1),$,t),z.frustumCulled=!1,z.setColorAt(0,r),j.add(z));const s=-n/2+.5*o,d=new V.Pq0,c=new V.PTz,u=(new V.Pq0).setScalar(o),p=new V.kn4,h=new V.NRn,f=(new V.kn4).copy(a.matrixWorld).invert(),w=new V.RlV;w.direction.set(0,0,1);let m=0;for(let t=0;t<e;t++)for(let n=0;n<e;n++)for(let a=0;a<e;a++){if(d.set(s+n*o,s+t*o,s+a*o),h.min.setScalar(-.5*o).add(d),h.max.setScalar(.5*o).add(d),l.intersectsBox(h,f))U.insideOnly||(p.compose(d,c,u),z.setMatrixAt(m,p),z.setColorAt(m,r),z.instanceMatrix.needsUpdate=!0,z.instanceColor.needsUpdate=!0,m++);else if(U.solid){w.origin.copy(d).applyMatrix4(f);const e=l.raycastFirst(w,2);e&&e.face.normal.dot(w.direction)>0&&(p.compose(d,c,u),z.setMatrixAt(m,p),z.setColorAt(m,i),z.instanceMatrix.needsUpdate=!0,z.instanceColor.needsUpdate=!0,m++)}z.count=m,yield}z.count=m}(),Q=!1),R){let e=window.performance.now();for(;window.performance.now()-e<16;)if(R.next().done){R=null;break}}T&&(T.object.scale.setScalar(U.scale),T.object.updateMatrixWorld(!0),T.update());for(const e in H){const t=H[e];t.model&&(t.model.visible=!1)}A.render(j,O)}function X(e){j.add(e.model),_=e,Q=!0}function N(e){U={...U,...e},Q=!0}var J=n(747);class K{constructor(e){this.name="WorkerBase",this.running=!1,this.worker=e,this.worker.onerror=e=>{throw e.message?new Error(`${this.name}: Could not create Web Worker with error "${e.message}"`):new Error(`${this.name}: Could not create Web Worker.`)}}runTask(){}generate(...e){if(this.running)throw new Error("GenerateMeshBVHWorker: Already running job.");if(null===this.worker)throw new Error("GenerateMeshBVHWorker: Worker has been disposed.");this.running=!0;const t=this.runTask(this.worker,...e);return t.finally(()=>{this.running=!1}),t}dispose(){this.worker.terminate(),this.worker=null}}class Z extends K{constructor(){super(new Worker(new URL(n.p+n.u(231),n.b),{type:void 0})),this.name="GenerateMeshBVHWorker"}runTask(e,t,n={}){return new Promise((o,r)=>{if(t.getAttribute("position").isInterleavedBufferAttribute||t.index&&t.index.isInterleavedBufferAttribute)throw new Error("GenerateMeshBVHWorker: InterleavedBufferAttribute are not supported for the geometry attributes.");e.onerror=e=>{r(new Error(`GenerateMeshBVHWorker: ${e.message}`))},e.onmessage=i=>{const{data:a}=i;if(a.error)r(new Error(a.error)),e.onmessage=null;else if(a.serialized){const{serialized:r,position:i}=a,l=J.G.deserialize(r,t,{setIndex:!1}),s=Object.assign({setBoundingBox:!0},n);if(t.attributes.position.array=i,r.index)if(t.index)t.index.array=r.index;else{const e=new V.THS(r.index,1,!1);t.setIndex(e)}s.setBoundingBox&&(t.boundingBox=l.getBoundingBox(new V.NRn)),n.onProgress&&n.onProgress(a.progress),o(l),e.onmessage=null}else n.onProgress&&n.onProgress(a.progress)};const i=t.index?t.index.array:null,a=t.attributes.position.array,l=[a];i&&l.push(i),e.postMessage({index:i,position:a,options:{...n,onProgress:null,includedProgressCallback:Boolean(n.onProgress),groups:[...t.groups]}},l.map(e=>e.buffer).filter(e=>"undefined"==typeof SharedArrayBuffer||!(e instanceof SharedArrayBuffer)))})}}var q=n(96),D=n(566);const Y=new V.V9B({transparent:!0,wireframe:!0,depthWrite:!1,opacity:.02});let ee,te;const ne={name:"FileManagerApp",data:()=>({selectedFile:null,uploadStatus:"",uploadedFiles:[],switch1:!1,switch2:!1,scaleValue:1.5,resolutionValue:40,opacityValue:1,filePanel:!1,sizeValue:1}),methods:{handleFileSelect(e){console.log(e);const t=e.target.files;t.length>0&&(this.selectedFile=t[0],console.log(this.selectedFile),this.uploadFile())},async uploadFile(){if(!this.selectedFile)return;ee&&(j.remove(ee),ee=null),this.uploadStatus="Загрузка...";const e=await this.selectedFile.arrayBuffer();(new L.B).setMeshoptDecoder(F.f).parse(e,"",e=>{ee=e.scene.children[0],ee.geometry.center(),ee.material=Y,ee.scale.setScalar(this.scaleValue),(new Z).generate(ee.geometry).then(e=>{te=e,X({model:ee,bvh:e}),this.filePanel=!1})})},removeFile(e){this.uploadedFiles.splice(e,1)},formatFileSize(e){if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]},handleButton1(){this.filePanel=!0},handleButton2(){},handleButton3(){!function(e){const t=function(e){const{geometry:t,count:n}=e,o=[],r=new V.kn4;for(let i=0;i<n;i++){e.getMatrixAt(i,r);const n=t.clone();n.applyMatrix4(r),o.push(n)}return D.pP(o)}(e),n=new V.eaF(t,e.material);(new q.r).parse(n,e=>{const t=new Blob([e instanceof ArrayBuffer?e:JSON.stringify(e)],{type:e instanceof ArrayBuffer?"application/octet-stream":"application/json"}),n=document.createElement("a");n.href=URL.createObjectURL(t),n.download=e instanceof ArrayBuffer?"scene.glb":"scene.gltf",n.click()},{binary:!0})}(z)},handleSwitch1(){console.log("Переключатель 1:",this.switch1)},handleSwitch2(){console.log("Переключатель 2:",this.switch2)},handleSlider1(){N({scale:this.scaleValue})},handleSlider2(){N({resolution:this.resolutionValue})},handleOpacity(){var e;e={opacity:this.opacityValue},Object.keys(e).forEach(t=>{$[t]=e[t]})},handleSize(){ee.scale.setScalar(this.sizeValue),X({model:ee,bvh:te})}}};var oe=n(262);const re=(0,oe.A)(ne,[["render",function(e,t,n,o,i,a){return(0,s.uX)(),(0,s.CE)("div",u,[i.filePanel?((0,s.uX)(),(0,s.CE)("div",p,[t[13]||(t[13]=(0,s.Lk)("h2",null,"Загрузка файла",-1)),(0,s.Lk)("div",h,[(0,s.Lk)("input",{type:"file",id:"fileInput",ref:"fileInput",onChange:t[0]||(t[0]=(...e)=>a.handleFileSelect&&a.handleFileSelect(...e)),class:"file-input"},null,544),t[11]||(t[11]=(0,s.Lk)("label",{for:"fileInput",class:"file-input-label"}," Выберите файл ",-1)),i.selectedFile?((0,s.uX)(),(0,s.CE)("span",f,(0,c.v_)(i.selectedFile.name),1)):(0,s.Q3)("v-if",!0)]),(0,s.Q3)(' <button @click="uploadFile" :disabled="!selectedFile" class="upload-button">\r\n                Загрузить\r\n            </button> '),i.uploadStatus?((0,s.uX)(),(0,s.CE)("div",w,(0,c.v_)(i.uploadStatus),1)):(0,s.Q3)("v-if",!0),i.uploadedFiles.length>0?((0,s.uX)(),(0,s.CE)("div",m,[t[12]||(t[12]=(0,s.Lk)("h3",null,"Загруженные файлы:",-1)),(0,s.Lk)("ul",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.uploadedFiles,(e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t},[(0,s.eW)((0,c.v_)(e.name)+" ("+(0,c.v_)(a.formatFileSize(e.size))+") ",1),(0,s.Lk)("button",{onClick:e=>a.removeFile(t),class:"remove-button"}," Удалить ",8,v)]))),128))])])):(0,s.Q3)("v-if",!0)])):(0,s.Q3)("v-if",!0),(0,s.Q3)(" Панель управления "),(0,s.Lk)("div",y,[(0,s.Lk)("div",b,[(0,s.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>a.handleButton1&&a.handleButton1(...e)),class:"control-button"},"Load model"),(0,s.Q3)(' <button @click="handleButton2" class="control-button">Build</button> '),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>a.handleButton3&&a.handleButton3(...e)),class:"control-button"},"Download")]),(0,s.Q3)(' <div class="switches-group">\r\n                <div class="switch-container">\r\n                    <label>\r\n                        <input type="checkbox" v-model="switch1" @change="handleSwitch1">\r\n                        Переключатель 1\r\n                    </label>\r\n                </div>\r\n                <div class="switch-container">\r\n                    <label>\r\n                        <input type="checkbox" v-model="switch2" @change="handleSwitch2">\r\n                        Переключатель 2\r\n                    </label>\r\n                </div>\r\n            </div> '),(0,s.Lk)("div",g,[(0,s.Lk)("div",k,[(0,s.Lk)("label",null,"Scale 1: "+(0,c.v_)(i.scaleValue),1),(0,s.bo)((0,s.Lk)("input",{type:"range",min:"0.1",max:"5",step:"0.1","onUpdate:modelValue":t[3]||(t[3]=e=>i.scaleValue=e),onInput:t[4]||(t[4]=(...e)=>a.handleSlider1&&a.handleSlider1(...e)),class:"slider"},null,544),[[r.Jo,i.scaleValue]])]),(0,s.Lk)("div",x,[(0,s.Lk)("label",null,"Resolution: "+(0,c.v_)(i.resolutionValue),1),(0,s.bo)((0,s.Lk)("input",{type:"range",min:"5",max:"75",step:"5","onUpdate:modelValue":t[5]||(t[5]=e=>i.resolutionValue=e),onInput:t[6]||(t[6]=(...e)=>a.handleSlider2&&a.handleSlider2(...e)),class:"slider"},null,544),[[r.Jo,i.resolutionValue]])]),(0,s.Lk)("div",B,[(0,s.Lk)("label",null,"Opacity: "+(0,c.v_)(i.opacityValue),1),(0,s.bo)((0,s.Lk)("input",{type:"range",min:"0",max:"1",step:"0.1","onUpdate:modelValue":t[7]||(t[7]=e=>i.opacityValue=e),onInput:t[8]||(t[8]=(...e)=>a.handleOpacity&&a.handleOpacity(...e)),class:"slider"},null,544),[[r.Jo,i.opacityValue]])]),(0,s.Lk)("div",S,[(0,s.Lk)("label",null,"Model size: "+(0,c.v_)(i.sizeValue),1),(0,s.bo)((0,s.Lk)("input",{type:"number",min:"0",step:"0.05","onUpdate:modelValue":t[9]||(t[9]=e=>i.sizeValue=e),onInput:t[10]||(t[10]=(...e)=>a.handleSize&&a.handleSize(...e)),class:"slider"},null,544),[[r.Jo,i.sizeValue]])])])])])}],["__scopeId","data-v-593c88a4"]]),ie={data:()=>({inGame:!1}),async mounted(){document.documentElement.setAttribute("data-theme","dark");const e=this.$refs.canvas;!function(e){const t=window.devicePixelRatio||1;e.forEach(e=>{e.width=e.clientWidth*t,e.height=e.clientHeight*t})}([e]),function(e){W=document.getElementById("output"),A=new P.JeP({antialias:!0,canvas:e}),A.setPixelRatio(window.devicePixelRatio),A.setSize(window.innerWidth,window.innerHeight),A.setClearColor(1449501,1),j=new V.Z58;const t=new V.ZyN(16777215,3);t.position.set(3,6,9),j.add(t);const n=new V.ZyN(16777215,.3);n.position.set(-3,-6,-9),j.add(n);const o=new V.$p8(16777215,.75);j.add(o),O=new V.ubm(75,window.innerWidth/window.innerHeight,.01,100),O.position.set(1,2,3),O.updateProjectionMatrix(),I=new E.N(O,A.domElement);const r=new V.eaF(new V.iNn);T=new V.IWo(r,16777215),T.material.opacity=.35,T.material.transparent=!0,j.add(T),window.addEventListener("resize",function(){O.aspect=window.innerWidth/window.innerHeight,O.updateProjectionMatrix(),A.setSize(window.innerWidth,window.innerHeight)},!1),G()}(e)},components:{Project:re}},ae=(0,oe.A)(ie,[["render",function(e,t,n,o,r,i){const a=(0,s.g2)("Project");return(0,s.uX)(),(0,s.CE)("div",d,[(0,s.bF)(a)])}]]),le=i.A.default||i.A,se=window.vue=(0,r.Ef)(ae);se.use(e=>{e.config.globalProperties.$app=le.Init(o),se.provide("app",e.config.globalProperties.$app)}),se.mount("#app")}},n={};function o(e){var r=n[e];if(void 0!==r)return r.exports;var i=n[e]={exports:{}};return t[e](i,i.exports,o),i.exports}o.m=t,e=[],o.O=(t,n,r,i)=>{if(!n){var a=1/0;for(c=0;c<e.length;c++){for(var[n,r,i]=e[c],l=!0,s=0;s<n.length;s++)(!1&i||a>=i)&&Object.keys(o.O).every(e=>o.O[e](n[s]))?n.splice(s--,1):(l=!1,i<a&&(a=i));if(l){e.splice(c--,1);var d=r();void 0!==d&&(t=d)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[n,r,i]},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.u=e=>e+".9962ce30.chunk.js",o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.j=792,o.p="/",(()=>{o.b=document.baseURI||self.location.href;var e={792:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var r,i,[a,l,s]=n,d=0;if(a.some(t=>0!==e[t])){for(r in l)o.o(l,r)&&(o.m[r]=l[r]);if(s)var c=s(o)}for(t&&t(n);d<a.length;d++)i=a[d],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(c)},n=self.webpackChunkvoxel_creator=self.webpackChunkvoxel_creator||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var r=o.O(void 0,[489,810,642,753,317,760,776,466],()=>o(767));r=o.O(r)})();