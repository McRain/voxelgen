(()=>{"use strict";var e,n={538:(e,n,t)=>{var o={};t.r(o),t.d(o,{user:()=>l});var r=t(751),i=t(302),a=t(953);i.A.default||i.A;const l=(0,a.Kh)({id:"mee"});var s=t(641);const d={class:"app-container"},c={id:"canvas",ref:"canvas"};var u=t(33);const p={class:"app-container"},h={key:0,class:"file-upload-panel"},f={class:"file-input-container"},w={key:0,class:"file-name"},m={key:0,class:"upload-status"},v={key:1,class:"uploaded-files"},y=["onClick"],b={class:"control-panel"},g={class:"buttons-group"},k={class:"sliders-group"},x={class:"slider-container"},B={class:"slider-container"},S={class:"slider-container"},L={class:"slider-container"};var F=t(888),V=t(51),P=t(922),M=t(437),E=t(409),C=t(24),A=t(912);let O,j,W,z,I,T,_;P.eaF.prototype.raycast=E.zQ,P.LoY.prototype.computeBoundsTree=E.LO,P.LoY.prototype.disposeBoundsTree=E.je,P.$Ed.prototype.computeBoundsTree=E.K5,P.$Ed.prototype.disposeBoundsTree=E.Of,P.$Ed.prototype.raycast=E.zQ;let Q,R=!1,U=null,H={model:"Torus Knot",scale:1.5,resolution:40,solid:!1,displayMesh:!0,displayBounds:!1,insideOnly:!1,rebuild:()=>R=!0};const $={},G=new P._4j({transparent:!0,opacity:1});function X(){if(requestAnimationFrame(X),W.updateMatrixWorld(!0),R&&(U=function*(){const e=H.resolution,n=e**3,t=H.scale,o=t/e,r=new P.Q1f(16777215),i=new P.Q1f(16761095).convertSRGBToLinear();I&&I.instanceMatrix.count!==n&&(I.material.dispose(),I.dispose(),I.parent.remove(I),I=null);const{model:a,bvh:l}=Q;if(!a)return;I||(I=new P.ZLX(new A.j(1,1,1,4,.1),G,n),I.frustumCulled=!1,I.setColorAt(0,r),W.add(I));const s=-t/2+.5*o,d=new P.Pq0,c=new P.PTz,u=(new P.Pq0).setScalar(o),p=new P.kn4,h=new P.NRn,f=(new P.kn4).copy(a.matrixWorld).invert(),w=new P.RlV;w.direction.set(0,0,1);let m=0;for(let n=0;n<e;n++)for(let t=0;t<e;t++)for(let a=0;a<e;a++){if(d.set(s+t*o,s+n*o,s+a*o),h.min.setScalar(-.5*o).add(d),h.max.setScalar(.5*o).add(d),l.intersectsBox(h,f))H.insideOnly||(p.compose(d,c,u),I.setMatrixAt(m,p),I.setColorAt(m,r),I.instanceMatrix.needsUpdate=!0,I.instanceColor.needsUpdate=!0,m++);else if(H.solid){w.origin.copy(d).applyMatrix4(f);const e=l.raycastFirst(w,2);e&&e.face.normal.dot(w.direction)>0&&(p.compose(d,c,u),I.setMatrixAt(m,p),I.setColorAt(m,i),I.instanceMatrix.needsUpdate=!0,I.instanceColor.needsUpdate=!0,m++)}I.count=m,yield}I.count=m}(),R=!1),U){let e=window.performance.now();for(;window.performance.now()-e<16;)if(U.next().done){U=null;break}}_&&(_.object.scale.setScalar(H.scale),_.object.updateMatrixWorld(!0),_.update());for(const e in $){const n=$[e];n.model&&(n.model.visible=!1)}O.render(W,j)}function N(e){W.add(e.model),Q=e,R=!0}function J(e){H={...H,...e},R=!0}var K=t(747);class Z{constructor(e){this.name="WorkerBase",this.running=!1,this.worker=e,this.worker.onerror=e=>{throw e.message?new Error(`${this.name}: Could not create Web Worker with error "${e.message}"`):new Error(`${this.name}: Could not create Web Worker.`)}}runTask(){}generate(...e){if(this.running)throw new Error("GenerateMeshBVHWorker: Already running job.");if(null===this.worker)throw new Error("GenerateMeshBVHWorker: Worker has been disposed.");this.running=!0;const n=this.runTask(this.worker,...e);return n.finally(()=>{this.running=!1}),n}dispose(){this.worker.terminate(),this.worker=null}}class q extends Z{constructor(){super(new Worker(new URL(t.p+t.u(231),t.b),{type:void 0})),this.name="GenerateMeshBVHWorker"}runTask(e,n,t={}){return new Promise((o,r)=>{if(n.getAttribute("position").isInterleavedBufferAttribute||n.index&&n.index.isInterleavedBufferAttribute)throw new Error("GenerateMeshBVHWorker: InterleavedBufferAttribute are not supported for the geometry attributes.");e.onerror=e=>{r(new Error(`GenerateMeshBVHWorker: ${e.message}`))},e.onmessage=i=>{const{data:a}=i;if(a.error)r(new Error(a.error)),e.onmessage=null;else if(a.serialized){const{serialized:r,position:i}=a,l=K.G.deserialize(r,n,{setIndex:!1}),s=Object.assign({setBoundingBox:!0},t);if(n.attributes.position.array=i,r.index)if(n.index)n.index.array=r.index;else{const e=new P.THS(r.index,1,!1);n.setIndex(e)}s.setBoundingBox&&(n.boundingBox=l.getBoundingBox(new P.NRn)),t.onProgress&&t.onProgress(a.progress),o(l),e.onmessage=null}else t.onProgress&&t.onProgress(a.progress)};const i=n.index?n.index.array:null,a=n.attributes.position.array,l=[a];i&&l.push(i),e.postMessage({index:i,position:a,options:{...t,onProgress:null,includedProgressCallback:Boolean(t.onProgress),groups:[...n.groups]}},l.map(e=>e.buffer).filter(e=>"undefined"==typeof SharedArrayBuffer||!(e instanceof SharedArrayBuffer)))})}}var D=t(96),Y=t(566);const ee=new P.V9B({transparent:!0,wireframe:!0,depthWrite:!1,opacity:.02});let ne,te;const oe={name:"FileManagerApp",data:()=>({selectedFile:null,uploadStatus:"",uploadedFiles:[],switch1:!1,switch2:!1,scaleValue:1.5,resolutionValue:40,opacityValue:1,filePanel:!1,sizeValue:1}),methods:{handleFileSelect(e){console.log(e);const n=e.target.files;n.length>0&&(this.selectedFile=n[0],console.log(this.selectedFile),this.uploadFile())},async uploadFile(){if(!this.selectedFile)return;ne&&(W.remove(ne),ne=null),this.uploadStatus="Загрузка...";const e=await this.selectedFile.arrayBuffer();(new F.B).setMeshoptDecoder(V.f).parse(e,"",e=>{ne=e.scene.children[0],ne.geometry.center(),ne.material=ee,ne.scale.setScalar(this.scaleValue),(new q).generate(ne.geometry).then(e=>{te=e,N({model:ne,bvh:e}),this.filePanel=!1})})},removeFile(e){this.uploadedFiles.splice(e,1)},formatFileSize(e){if(0===e)return"0 Bytes";const n=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,n)).toFixed(2))+" "+["Bytes","KB","MB","GB"][n]},handleButton1(){this.filePanel=!0},handleButton2(){},handleButton3(){!function(e){const n=function(e){const{geometry:n,count:t}=e,o=[],r=new P.kn4;for(let i=0;i<t;i++){e.getMatrixAt(i,r);const t=n.clone();t.applyMatrix4(r),o.push(t)}return Y.pP(o)}(e),t=new P.eaF(n,e.material);(new D.r).parse(t,e=>{const n=new Blob([e instanceof ArrayBuffer?e:JSON.stringify(e)],{type:e instanceof ArrayBuffer?"application/octet-stream":"application/json"}),t=document.createElement("a");t.href=URL.createObjectURL(n),t.download=e instanceof ArrayBuffer?"scene.glb":"scene.gltf",t.click()},{binary:!0})}(I)},handleSwitch1(){console.log("Переключатель 1:",this.switch1)},handleSwitch2(){console.log("Переключатель 2:",this.switch2)},handleSlider1(){J({scale:this.scaleValue})},handleSlider2(){J({resolution:this.resolutionValue})},handleOpacity(){var e;e={opacity:this.opacityValue},Object.keys(e).forEach(n=>{G[n]=e[n]})},handleSize(){ne.scale.setScalar(this.sizeValue),N({model:ne,bvh:te})}}};var re=t(262);const ie=(0,re.A)(oe,[["render",function(e,n,t,o,i,a){return(0,s.uX)(),(0,s.CE)("div",p,[i.filePanel?((0,s.uX)(),(0,s.CE)("div",h,[n[13]||(n[13]=(0,s.Lk)("h2",null,"Загрузка файла",-1)),(0,s.Lk)("div",f,[(0,s.Lk)("input",{type:"file",id:"fileInput",ref:"fileInput",onChange:n[0]||(n[0]=(...e)=>a.handleFileSelect&&a.handleFileSelect(...e)),class:"file-input"},null,544),n[11]||(n[11]=(0,s.Lk)("label",{for:"fileInput",class:"file-input-label"}," Выберите файл ",-1)),i.selectedFile?((0,s.uX)(),(0,s.CE)("span",w,(0,u.v_)(i.selectedFile.name),1)):(0,s.Q3)("v-if",!0)]),(0,s.Q3)(' <button @click="uploadFile" :disabled="!selectedFile" class="upload-button">\r\n                Загрузить\r\n            </button> '),i.uploadStatus?((0,s.uX)(),(0,s.CE)("div",m,(0,u.v_)(i.uploadStatus),1)):(0,s.Q3)("v-if",!0),i.uploadedFiles.length>0?((0,s.uX)(),(0,s.CE)("div",v,[n[12]||(n[12]=(0,s.Lk)("h3",null,"Загруженные файлы:",-1)),(0,s.Lk)("ul",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.uploadedFiles,(e,n)=>((0,s.uX)(),(0,s.CE)("li",{key:n},[(0,s.eW)((0,u.v_)(e.name)+" ("+(0,u.v_)(a.formatFileSize(e.size))+") ",1),(0,s.Lk)("button",{onClick:e=>a.removeFile(n),class:"remove-button"}," Удалить ",8,y)]))),128))])])):(0,s.Q3)("v-if",!0)])):(0,s.Q3)("v-if",!0),(0,s.Q3)(" Панель управления "),(0,s.Lk)("div",b,[(0,s.Lk)("div",g,[(0,s.Lk)("button",{onClick:n[1]||(n[1]=(...e)=>a.handleButton1&&a.handleButton1(...e)),class:"control-button"},"Load model"),(0,s.Q3)(' <button @click="handleButton2" class="control-button">Build</button> '),(0,s.Lk)("button",{onClick:n[2]||(n[2]=(...e)=>a.handleButton3&&a.handleButton3(...e)),class:"control-button"},"Download")]),(0,s.Q3)(' <div class="switches-group">\r\n                <div class="switch-container">\r\n                    <label>\r\n                        <input type="checkbox" v-model="switch1" @change="handleSwitch1">\r\n                        Переключатель 1\r\n                    </label>\r\n                </div>\r\n                <div class="switch-container">\r\n                    <label>\r\n                        <input type="checkbox" v-model="switch2" @change="handleSwitch2">\r\n                        Переключатель 2\r\n                    </label>\r\n                </div>\r\n            </div> '),(0,s.Lk)("div",k,[(0,s.Lk)("div",x,[(0,s.Lk)("label",null,"Scale 1: "+(0,u.v_)(i.scaleValue),1),(0,s.bo)((0,s.Lk)("input",{type:"range",min:"0.1",max:"5",step:"0.1","onUpdate:modelValue":n[3]||(n[3]=e=>i.scaleValue=e),onInput:n[4]||(n[4]=(...e)=>a.handleSlider1&&a.handleSlider1(...e)),class:"slider"},null,544),[[r.Jo,i.scaleValue]])]),(0,s.Lk)("div",B,[(0,s.Lk)("label",null,"Resolution: "+(0,u.v_)(i.resolutionValue),1),(0,s.bo)((0,s.Lk)("input",{type:"range",min:"5",max:"75",step:"5","onUpdate:modelValue":n[5]||(n[5]=e=>i.resolutionValue=e),onInput:n[6]||(n[6]=(...e)=>a.handleSlider2&&a.handleSlider2(...e)),class:"slider"},null,544),[[r.Jo,i.resolutionValue]])]),(0,s.Lk)("div",S,[(0,s.Lk)("label",null,"Opacity: "+(0,u.v_)(i.opacityValue),1),(0,s.bo)((0,s.Lk)("input",{type:"range",min:"0",max:"1",step:"0.1","onUpdate:modelValue":n[7]||(n[7]=e=>i.opacityValue=e),onInput:n[8]||(n[8]=(...e)=>a.handleOpacity&&a.handleOpacity(...e)),class:"slider"},null,544),[[r.Jo,i.opacityValue]])]),(0,s.Lk)("div",L,[(0,s.Lk)("label",null,"Model size: "+(0,u.v_)(i.sizeValue),1),(0,s.bo)((0,s.Lk)("input",{type:"number",min:"0",step:"0.05","onUpdate:modelValue":n[9]||(n[9]=e=>i.sizeValue=e),onInput:n[10]||(n[10]=(...e)=>a.handleSize&&a.handleSize(...e)),class:"slider"},null,544),[[r.Jo,i.sizeValue]])])])])])}],["__scopeId","data-v-593c88a4"]]),ae={data:()=>({inGame:!1}),async mounted(){document.documentElement.setAttribute("data-theme","dark");const e=this.$refs.canvas;!function(e){const n=window.devicePixelRatio||1;e.forEach(e=>{e.width=e.clientWidth*n,e.height=e.clientHeight*n})}([e]),function(e){z=document.getElementById("output"),O=new M.JeP({antialias:!0,canvas:e}),O.setPixelRatio(window.devicePixelRatio),O.setSize(window.innerWidth,window.innerHeight),O.setClearColor(1449501,1),W=new P.Z58;const n=new P.ZyN(16777215,3);n.position.set(3,6,9),W.add(n);const t=new P.ZyN(16777215,.3);t.position.set(-3,-6,-9),W.add(t);const o=new P.$p8(16777215,.75);W.add(o),j=new P.ubm(75,window.innerWidth/window.innerHeight,.01,100),j.position.set(1,2,3),j.updateProjectionMatrix(),T=new C.N(j,O.domElement);const r=new P.eaF(new P.iNn);_=new P.IWo(r,16777215),_.material.opacity=.35,_.material.transparent=!0,W.add(_),window.addEventListener("resize",function(){j.aspect=window.innerWidth/window.innerHeight,j.updateProjectionMatrix(),O.setSize(window.innerWidth,window.innerHeight)},!1),X()}(e)},components:{Project:ie}},le=(0,re.A)(ae,[["render",function(e,n,t,o,r,i){const a=(0,s.g2)("Project");return(0,s.uX)(),(0,s.CE)("div",d,[(0,s.Lk)("canvas",c,null,512),(0,s.bF)(a)])}]]),se=i.A.default||i.A,de=window.vue=(0,r.Ef)(le);de.use(e=>{e.config.globalProperties.$app=se.Init(o),de.provide("app",e.config.globalProperties.$app)}),de.mount("#app")}},t={};function o(e){var r=t[e];if(void 0!==r)return r.exports;var i=t[e]={exports:{}};return n[e](i,i.exports,o),i.exports}o.m=n,e=[],o.O=(n,t,r,i)=>{if(!t){var a=1/0;for(c=0;c<e.length;c++){for(var[t,r,i]=e[c],l=!0,s=0;s<t.length;s++)(!1&i||a>=i)&&Object.keys(o.O).every(e=>o.O[e](t[s]))?t.splice(s--,1):(l=!1,i<a&&(a=i));if(l){e.splice(c--,1);var d=r();void 0!==d&&(n=d)}}return n}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[t,r,i]},o.d=(e,n)=>{for(var t in n)o.o(n,t)&&!o.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},o.u=e=>e+".9962ce30.chunk.js",o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.j=792,o.p="/",(()=>{o.b=document.baseURI||self.location.href;var e={792:0};o.O.j=n=>0===e[n];var n=(n,t)=>{var r,i,[a,l,s]=t,d=0;if(a.some(n=>0!==e[n])){for(r in l)o.o(l,r)&&(o.m[r]=l[r]);if(s)var c=s(o)}for(n&&n(t);d<a.length;d++)i=a[d],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(c)},t=self.webpackChunkvoxel_creator=self.webpackChunkvoxel_creator||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))})();var r=o.O(void 0,[489,810,642,753,317,760,776,466],()=>o(538));r=o.O(r)})();