(()=>{"use strict";var e,t={140:(e,t,n)=>{var o={};n.r(o),n.d(o,{user:()=>i});var r=n(751),a=n(302),l=n(953);a.A.default||a.A;const i=(0,l.Kh)({id:"mee"});var s=n(641);const d={class:"app-container"},c={id:"canvas",ref:"canvas"};var u=n(33);const p={class:"app-container"},h={key:0,class:"file-upload-panel"},f={class:"file-input-container"},m={key:0,class:"file-name"},w={key:0,class:"upload-status"},b={key:1,class:"uploaded-files"},v=["onClick"],y={class:"control-panel"},g={class:"buttons-group"},k={class:"switches-group"},x={class:"switch-container"},B={class:"sliders-group"},L={class:"slider-container"},S={class:"slider-container"},C={class:"slider-container"},M={class:"slider-container"};var V=n(888),F=n(51),P=n(922),E=n(437),O=n(409),j=n(24),A=n(554),W=n(566);function z(e){const{geometry:t,count:n}=e,o=[],r=new P.kn4;for(let a=0;a<n;a++){e.getMatrixAt(a,r);const n=t.clone();n.applyMatrix4(r),o.push(n)}return W.pP(o)}let I,R,T,U,_,Q,H;P.eaF.prototype.raycast=O.zQ,P.LoY.prototype.computeBoundsTree=O.LO,P.LoY.prototype.disposeBoundsTree=O.je,P.$Ed.prototype.computeBoundsTree=O.K5,P.$Ed.prototype.disposeBoundsTree=O.Of,P.$Ed.prototype.raycast=O.zQ;let $,G,X,N=!1,J=null;const K=new P.mrM({color:0,linewidth:.5});let D={model:"Torus Knot",scale:1.5,resolution:40,solid:!1,displayMesh:!0,displayBounds:!1,insideOnly:!1,randomcolor:!1,rebuild:()=>N=!0};const Z={},q=new P._4j({transparent:!0,opacity:1});function Y(){if(requestAnimationFrame(Y),T.updateMatrixWorld(!0),N&&(J=function*(){const e=D.resolution;X=e**3;const t=D.scale,n=t/e,o=new P.Q1f(16777215),r=new P.Q1f(16761095).convertSRGBToLinear();_&&_.instanceMatrix.count!==X&&(_.material.dispose(),_.dispose(),_.parent.remove(_),_=null);const{model:a,bvh:l}=$;if(!a)return;_||(_=new P.ZLX(new P.iNn(1,1,1),q,X),_.frustumCulled=!1,_.setColorAt(0,o),T.add(_));const i=-t/2+.5*n,s=new P.Pq0,d=new P.PTz,c=(new P.Pq0).setScalar(n),u=new P.kn4,p=new P.NRn,h=(new P.kn4).copy(a.matrixWorld).invert(),f=new P.RlV;f.direction.set(0,0,1);let m=0;for(let t=0;t<e;t++)for(let a=0;a<e;a++)for(let w=0;w<e;w++){if(s.set(i+a*n,i+t*n,i+w*n),p.min.setScalar(-.5*n).add(s),p.max.setScalar(.5*n).add(s),l.intersectsBox(p,h))D.insideOnly||(u.compose(s,d,c),_.setMatrixAt(m,u),_.setColorAt(m,o),_.instanceMatrix.needsUpdate=!0,_.instanceColor.needsUpdate=!0,m++);else if(D.solid){f.origin.copy(s).applyMatrix4(h);const e=l.raycastFirst(f,2);e&&e.face.normal.dot(f.direction)>0&&(u.compose(s,d,c),_.setMatrixAt(m,u),_.setColorAt(m,r),_.instanceMatrix.needsUpdate=!0,_.instanceColor.needsUpdate=!0,m++)}_.count=m,yield}_.count=m}(),N=!1),J){let e=window.performance.now();for(;window.performance.now()-e<16;)if(J.next().done){if(J=null,D.randomcolor){const e=new P.Q1f;for(let t=0;t<X;t++)e.setRGB(Math.random(),Math.random(),Math.random()),_.setColorAt(t,e);_.instanceColor.needsUpdate=!0}const e=z(_);G&&T.remove(G),G=new P.DXC(new P.TDQ(e),K),T.add(G),G.renderOrder=0;break}}H&&(H.object.scale.setScalar(D.scale),H.object.updateMatrixWorld(!0),H.update());for(const e in Z){const t=Z[e];t.model&&(t.model.visible=!1)}I.render(T,R)}function ee(e){T.add(e.model),$=e,N=!0}function te(e){D={...D,...e},N=!0}var ne=n(747);class oe{constructor(e){this.name="WorkerBase",this.running=!1,this.worker=e,this.worker.onerror=e=>{throw e.message?new Error(`${this.name}: Could not create Web Worker with error "${e.message}"`):new Error(`${this.name}: Could not create Web Worker.`)}}runTask(){}generate(...e){if(this.running)throw new Error("GenerateMeshBVHWorker: Already running job.");if(null===this.worker)throw new Error("GenerateMeshBVHWorker: Worker has been disposed.");this.running=!0;const t=this.runTask(this.worker,...e);return t.finally(()=>{this.running=!1}),t}dispose(){this.worker.terminate(),this.worker=null}}class re extends oe{constructor(){super(new Worker(new URL(n.p+n.u(231),n.b),{type:void 0})),this.name="GenerateMeshBVHWorker"}runTask(e,t,n={}){return new Promise((o,r)=>{if(t.getAttribute("position").isInterleavedBufferAttribute||t.index&&t.index.isInterleavedBufferAttribute)throw new Error("GenerateMeshBVHWorker: InterleavedBufferAttribute are not supported for the geometry attributes.");e.onerror=e=>{r(new Error(`GenerateMeshBVHWorker: ${e.message}`))},e.onmessage=a=>{const{data:l}=a;if(l.error)r(new Error(l.error)),e.onmessage=null;else if(l.serialized){const{serialized:r,position:a}=l,i=ne.G.deserialize(r,t,{setIndex:!1}),s=Object.assign({setBoundingBox:!0},n);if(t.attributes.position.array=a,r.index)if(t.index)t.index.array=r.index;else{const e=new P.THS(r.index,1,!1);t.setIndex(e)}s.setBoundingBox&&(t.boundingBox=i.getBoundingBox(new P.NRn)),n.onProgress&&n.onProgress(l.progress),o(i),e.onmessage=null}else n.onProgress&&n.onProgress(l.progress)};const a=t.index?t.index.array:null,l=t.attributes.position.array,i=[l];a&&i.push(a),e.postMessage({index:a,position:l,options:{...n,onProgress:null,includedProgressCallback:Boolean(n.onProgress),groups:[...t.groups]}},i.map(e=>e.buffer).filter(e=>"undefined"==typeof SharedArrayBuffer||!(e instanceof SharedArrayBuffer)))})}}const ae=new P.V9B({transparent:!0,wireframe:!0,depthWrite:!1,opacity:.02});let le,ie;const se={name:"FileManagerApp",data:()=>({selectedFile:null,uploadStatus:"",uploadedFiles:[],randomColor:!1,switch2:!1,scaleValue:1.5,resolutionValue:40,opacityValue:1,filePanel:!1,sizeValue:1}),methods:{handleFileSelect(e){const t=e.target.files;t.length>0&&(this.selectedFile=t[0],this.uploadFile())},async uploadFile(){if(!this.selectedFile)return;le&&(T.remove(le),le=null),this.uploadStatus="Загрузка...";const e=await this.selectedFile.arrayBuffer();(new V.B).setMeshoptDecoder(F.f).parse(e,"",e=>{for(le=e.scene;!le.geometry;)le=le.children[0];le.geometry.center(),le.material=ae,le.scale.setScalar(this.scaleValue),(new re).generate(le.geometry).then(e=>{ie=e,ee({model:le,bvh:e}),this.filePanel=!1})})},removeFile(e){this.uploadedFiles.splice(e,1)},formatFileSize(e){if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]},handleButton1(){this.filePanel=!0},handleButton2(){},handleButton3(){!function(e,t="model.obj"){try{const n=z(e),o=new P.eaF(n,Array.isArray(e.material)?e.material[0]:e.material),r=(new A.j).parse(o),a=new Blob([r],{type:"text/plain"}),l=document.createElement("a");l.href=URL.createObjectURL(a),l.download=t,l.click(),URL.revokeObjectURL(l.href)}catch(e){console.error("Export error:",e)}}(_)},handleSwitch1(){te({randomcolor:this.randomColor})},handleSwitch2(){},handleSlider1(){te({scale:this.scaleValue})},handleSlider2(){te({resolution:this.resolutionValue})},handleOpacity(){var e;e={opacity:this.opacityValue},Object.keys(e).forEach(t=>{q[t]=e[t]})},handleSize(){le.scale.setScalar(this.sizeValue),ee({model:le,bvh:ie})}}};var de=n(262);const ce=(0,de.A)(se,[["render",function(e,t,n,o,a,l){return(0,s.uX)(),(0,s.CE)("div",p,[a.filePanel?((0,s.uX)(),(0,s.CE)("div",h,[t[15]||(t[15]=(0,s.Lk)("h2",null,"Загрузка файла",-1)),(0,s.Lk)("div",f,[(0,s.Lk)("input",{type:"file",id:"fileInput",ref:"fileInput",onChange:t[0]||(t[0]=(...e)=>l.handleFileSelect&&l.handleFileSelect(...e)),class:"file-input"},null,544),t[13]||(t[13]=(0,s.Lk)("label",{for:"fileInput",class:"file-input-label"}," Выберите файл ",-1)),a.selectedFile?((0,s.uX)(),(0,s.CE)("span",m,(0,u.v_)(a.selectedFile.name),1)):(0,s.Q3)("v-if",!0)]),(0,s.Q3)(' <button @click="uploadFile" :disabled="!selectedFile" class="upload-button">\r\n                Загрузить\r\n            </button> '),a.uploadStatus?((0,s.uX)(),(0,s.CE)("div",w,(0,u.v_)(a.uploadStatus),1)):(0,s.Q3)("v-if",!0),a.uploadedFiles.length>0?((0,s.uX)(),(0,s.CE)("div",b,[t[14]||(t[14]=(0,s.Lk)("h3",null,"Загруженные файлы:",-1)),(0,s.Lk)("ul",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.uploadedFiles,(e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t},[(0,s.eW)((0,u.v_)(e.name)+" ("+(0,u.v_)(l.formatFileSize(e.size))+") ",1),(0,s.Lk)("button",{onClick:e=>l.removeFile(t),class:"remove-button"}," Удалить ",8,v)]))),128))])])):(0,s.Q3)("v-if",!0)])):(0,s.Q3)("v-if",!0),(0,s.Q3)(" Панель управления "),(0,s.Lk)("div",y,[(0,s.Lk)("div",g,[(0,s.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>l.handleButton1&&l.handleButton1(...e)),class:"control-button"},"Load model"),(0,s.Q3)(' <button @click="handleButton2" class="control-button">Build</button> '),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>l.handleButton3&&l.handleButton3(...e)),class:"control-button"},"Download")]),(0,s.Lk)("div",k,[(0,s.Lk)("div",x,[(0,s.Lk)("label",null,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=e=>a.randomColor=e),onChange:t[4]||(t[4]=(...e)=>l.handleSwitch1&&l.handleSwitch1(...e))},null,544),[[r.lH,a.randomColor]]),t[16]||(t[16]=(0,s.eW)(" Random colors "))])]),(0,s.Q3)(' <div class="switch-container">\r\n                    <label>\r\n                        <input type="checkbox" v-model="switch2" @change="handleSwitch2">\r\n                        Переключатель 2\r\n                    </label>\r\n                </div> ')]),(0,s.Lk)("div",B,[(0,s.Lk)("div",L,[(0,s.Lk)("label",null,"Scale 1: "+(0,u.v_)(a.scaleValue),1),(0,s.bo)((0,s.Lk)("input",{type:"range",min:"0.1",max:"5",step:"0.1","onUpdate:modelValue":t[5]||(t[5]=e=>a.scaleValue=e),onInput:t[6]||(t[6]=(...e)=>l.handleSlider1&&l.handleSlider1(...e)),class:"slider"},null,544),[[r.Jo,a.scaleValue]])]),(0,s.Lk)("div",S,[(0,s.Lk)("label",null,"Resolution: "+(0,u.v_)(a.resolutionValue),1),(0,s.bo)((0,s.Lk)("input",{type:"range",min:"5",max:"75",step:"5","onUpdate:modelValue":t[7]||(t[7]=e=>a.resolutionValue=e),onInput:t[8]||(t[8]=(...e)=>l.handleSlider2&&l.handleSlider2(...e)),class:"slider"},null,544),[[r.Jo,a.resolutionValue]])]),(0,s.Lk)("div",C,[(0,s.Lk)("label",null,"Opacity: "+(0,u.v_)(a.opacityValue),1),(0,s.bo)((0,s.Lk)("input",{type:"range",min:"0",max:"1",step:"0.1","onUpdate:modelValue":t[9]||(t[9]=e=>a.opacityValue=e),onInput:t[10]||(t[10]=(...e)=>l.handleOpacity&&l.handleOpacity(...e)),class:"slider"},null,544),[[r.Jo,a.opacityValue]])]),(0,s.Lk)("div",M,[(0,s.Lk)("label",null,"Model size: "+(0,u.v_)(a.sizeValue),1),(0,s.bo)((0,s.Lk)("input",{type:"number",min:"0",step:"0.05","onUpdate:modelValue":t[11]||(t[11]=e=>a.sizeValue=e),onInput:t[12]||(t[12]=(...e)=>l.handleSize&&l.handleSize(...e)),class:"slider"},null,544),[[r.Jo,a.sizeValue]])])])])])}],["__scopeId","data-v-5fe55788"]]),ue={data:()=>({inGame:!1}),async mounted(){document.documentElement.setAttribute("data-theme","dark");const e=this.$refs.canvas;!function(e){const t=window.devicePixelRatio||1;e.forEach(e=>{e.width=e.clientWidth*t,e.height=e.clientHeight*t})}([e]),function(e){U=document.getElementById("output"),I=new E.JeP({antialias:!0,canvas:e}),I.setPixelRatio(window.devicePixelRatio),I.setSize(window.innerWidth,window.innerHeight),I.setClearColor(1449501,1),T=new P.Z58;const t=new P.ZyN(16777215,2);t.position.set(3,6,9),T.add(t);const n=new P.ZyN(16777215,.5);n.position.set(-3,-6,-9),T.add(n);const o=new P.$p8(16777215,.75);T.add(o),R=new P.ubm(75,window.innerWidth/window.innerHeight,.01,100),R.position.set(1,2,3),R.updateProjectionMatrix(),Q=new j.N(R,I.domElement);const r=new P.eaF(new P.iNn);H=new P.IWo(r,16777215),H.material.opacity=.35,H.material.transparent=!0,T.add(H),window.addEventListener("resize",function(){R.aspect=window.innerWidth/window.innerHeight,R.updateProjectionMatrix(),I.setSize(window.innerWidth,window.innerHeight)},!1),Y()}(e)},components:{Project:ce}},pe=(0,de.A)(ue,[["render",function(e,t,n,o,r,a){const l=(0,s.g2)("Project");return(0,s.uX)(),(0,s.CE)("div",d,[(0,s.Lk)("canvas",c,null,512),(0,s.bF)(l)])}]]),he=a.A.default||a.A,fe=window.vue=(0,r.Ef)(pe);fe.use(e=>{e.config.globalProperties.$app=he.Init(o),fe.provide("app",e.config.globalProperties.$app)}),fe.mount("#app")}},n={};function o(e){var r=n[e];if(void 0!==r)return r.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,o),a.exports}o.m=t,e=[],o.O=(t,n,r,a)=>{if(!n){var l=1/0;for(c=0;c<e.length;c++){for(var[n,r,a]=e[c],i=!0,s=0;s<n.length;s++)(!1&a||l>=a)&&Object.keys(o.O).every(e=>o.O[e](n[s]))?n.splice(s--,1):(i=!1,a<l&&(l=a));if(i){e.splice(c--,1);var d=r();void 0!==d&&(t=d)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[n,r,a]},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.u=e=>e+".4a724805.chunk.js",o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.j=792,o.p="/",(()=>{o.b=document.baseURI||self.location.href;var e={792:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var r,a,[l,i,s]=n,d=0;if(l.some(t=>0!==e[t])){for(r in i)o.o(i,r)&&(o.m[r]=i[r]);if(s)var c=s(o)}for(t&&t(n);d<l.length;d++)a=l[d],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(c)},n=self.webpackChunkvoxel_creator=self.webpackChunkvoxel_creator||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var r=o.O(void 0,[489,810,642,753,776,466],()=>o(140));r=o.O(r)})();